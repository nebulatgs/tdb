var mi=Object.create;var He=Object.defineProperty;var gi=Object.getOwnPropertyDescriptor;var wi=Object.getOwnPropertyNames;var bi=Object.getPrototypeOf,yi=Object.prototype.hasOwnProperty;var Si=(r,t)=>()=>(r&&(t=r(r=0)),t);var pe=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports);var Ei=(r,t,e,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of wi(t))!yi.call(r,i)&&i!==e&&He(r,i,{get:()=>t[i],enumerable:!(s=gi(t,i))||s.enumerable});return r};var me=(r,t,e)=>(e=r!=null?mi(bi(r)):{},Ei(t||!r||!r.__esModule?He(e,"default",{value:r,enumerable:!0}):e,r));import{createRequire as vi}from"node:module";import xi from"node:path";import Ci from"node:url";var w=Si(()=>{"use strict";globalThis.require=vi(import.meta.url);globalThis.__filename=Ci.fileURLToPath(import.meta.url);globalThis.__dirname=xi.dirname(__filename)});var Qe=pe((_n,Ze)=>{"use strict";w();Ze.exports=Ye;function Ye(r,t,e){r instanceof RegExp&&(r=Ke(r,e)),t instanceof RegExp&&(t=Ke(t,e));var s=Ve(r,t,e);return s&&{start:s[0],end:s[1],pre:e.slice(0,s[0]),body:e.slice(s[0]+r.length,s[1]),post:e.slice(s[1]+t.length)}}function Ke(r,t){var e=t.match(r);return e?e[0]:null}Ye.range=Ve;function Ve(r,t,e){var s,i,n,o,h,a=e.indexOf(r),l=e.indexOf(t,a+1),c=a;if(a>=0&&l>0){if(r===t)return[a,l];for(s=[],n=e.length;c>=0&&!h;)c==a?(s.push(c),a=e.indexOf(r,c+1)):s.length==1?h=[s.pop(),l]:(i=s.pop(),i<n&&(n=i,o=l),l=e.indexOf(t,c+1)),c=a<l&&a>=0?a:l;s.length&&(h=[n,o])}return h}});var ns=pe((Dn,rs)=>{w();var Je=Qe();rs.exports=ki;var Xe="\0SLASH"+Math.random()+"\0",ts="\0OPEN"+Math.random()+"\0",we="\0CLOSE"+Math.random()+"\0",es="\0COMMA"+Math.random()+"\0",ss="\0PERIOD"+Math.random()+"\0";function ge(r){return parseInt(r,10)==r?parseInt(r,10):r.charCodeAt(0)}function Ti(r){return r.split("\\\\").join(Xe).split("\\{").join(ts).split("\\}").join(we).split("\\,").join(es).split("\\.").join(ss)}function Ai(r){return r.split(Xe).join("\\").split(ts).join("{").split(we).join("}").split(es).join(",").split(ss).join(".")}function is(r){if(!r)return[""];var t=[],e=Je("{","}",r);if(!e)return r.split(",");var s=e.pre,i=e.body,n=e.post,o=s.split(",");o[o.length-1]+="{"+i+"}";var h=is(n);return n.length&&(o[o.length-1]+=h.shift(),o.push.apply(o,h)),t.push.apply(t,o),t}function ki(r){return r?(r.substr(0,2)==="{}"&&(r="\\{\\}"+r.substr(2)),bt(Ti(r),!0).map(Ai)):[]}function Oi(r){return"{"+r+"}"}function Ri(r){return/^-?0\d/.test(r)}function Ni(r,t){return r<=t}function Bi(r,t){return r>=t}function bt(r,t){var e=[],s=Je("{","}",r);if(!s)return[r];var i=s.pre,n=s.post.length?bt(s.post,!1):[""];if(/\$$/.test(s.pre))for(var o=0;o<n.length;o++){var h=i+"{"+s.body+"}"+n[o];e.push(h)}else{var a=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(s.body),l=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(s.body),c=a||l,f=s.body.indexOf(",")>=0;if(!c&&!f)return s.post.match(/,.*\}/)?(r=s.pre+"{"+s.body+we+s.post,bt(r)):[r];var u;if(c)u=s.body.split(/\.\./);else if(u=is(s.body),u.length===1&&(u=bt(u[0],!1).map(Oi),u.length===1))return n.map(function(Lt){return s.pre+u[0]+Lt});var d;if(c){var m=ge(u[0]),p=ge(u[1]),b=Math.max(u[0].length,u[1].length),g=u.length==3?Math.abs(ge(u[2])):1,S=Ni,E=p<m;E&&(g*=-1,S=Bi);var y=u.some(Ri);d=[];for(var v=m;S(v,p);v+=g){var A;if(l)A=String.fromCharCode(v),A==="\\"&&(A="");else if(A=String(v),y){var z=b-A.length;if(z>0){var it=new Array(z+1).join("0");v<0?A="-"+it+A.slice(1):A=it+A}}d.push(A)}}else{d=[];for(var $=0;$<u.length;$++)d.push.apply(d,bt(u[$],!1))}for(var $=0;$<d.length;$++)for(var o=0;o<n.length;o++){var h=i+d[$]+n[o];(!t||c||h)&&e.push(h)}}return e}});var Ue=pe(Ft=>{w();(function(r,t){"use strict";typeof Ft=="object"?(r.slip=Ft,t(Ft)):typeof define=="function"&&define.amd?define(["exports"],function(e){return r.slip=e,r.slip,t(e)}):(r.slip={},t(r.slip))})(Ft,function(r){"use strict";var t=r;t.END=192,t.ESC=219,t.ESC_END=220,t.ESC_ESC=221,t.byteArray=function(s,i,n){return s instanceof ArrayBuffer?new Uint8Array(s,i,n):s},t.expandByteArray=function(s){var i=new Uint8Array(s.length*2);return i.set(s),i},t.sliceByteArray=function(s,i,n){var o=s.buffer.slice?s.buffer.slice(i,n):s.subarray(i,n);return new Uint8Array(o)},t.encode=function(s,i){i=i||{},i.bufferPadding=i.bufferPadding||4,s=t.byteArray(s,i.offset,i.byteLength);var n=s.length+i.bufferPadding+3&-4,o=new Uint8Array(n),h=1;o[0]=t.END;for(var a=0;a<s.length;a++){h>o.length-3&&(o=t.expandByteArray(o));var l=s[a];l===t.END?(o[h++]=t.ESC,l=t.ESC_END):l===t.ESC&&(o[h++]=t.ESC,l=t.ESC_ESC),o[h++]=l}return o[h]=t.END,t.sliceByteArray(o,0,h+1)},t.Decoder=function(s){s=typeof s!="function"?s||{}:{onMessage:s},this.maxMessageSize=s.maxMessageSize||10485760,this.bufferSize=s.bufferSize||1024,this.msgBuffer=new Uint8Array(this.bufferSize),this.msgBufferIdx=0,this.onMessage=s.onMessage,this.onError=s.onError,this.escape=!1};var e=t.Decoder.prototype;return e.decode=function(s){s=t.byteArray(s);for(var i,n=0;n<s.length;n++){var o=s[n];if(this.escape)o===t.ESC_ESC?o=t.ESC:o===t.ESC_END&&(o=t.END);else{if(o===t.ESC){this.escape=!0;continue}if(o===t.END){i=this.handleEnd();continue}}var h=this.addByte(o);h||this.handleMessageMaxError()}return i},e.handleMessageMaxError=function(){this.onError&&this.onError(this.msgBuffer.subarray(0),"The message is too large; the maximum message size is "+this.maxMessageSize/1024+"KB. Use a larger maxMessageSize if necessary."),this.msgBufferIdx=0,this.escape=!1},e.addByte=function(s){return this.msgBufferIdx>this.msgBuffer.length-1&&(this.msgBuffer=t.expandByteArray(this.msgBuffer)),this.msgBuffer[this.msgBufferIdx++]=s,this.escape=!1,this.msgBuffer.length<this.maxMessageSize},e.handleEnd=function(){if(this.msgBufferIdx!==0){var s=t.sliceByteArray(this.msgBuffer,0,this.msgBufferIdx);return this.onMessage&&this.onMessage(s),this.msgBufferIdx=0,s}},t})});w();import{writeFile as kn}from"fs/promises";import On from"path";w();w();w();w();var ds=me(ns(),1);w();var yt=r=>{if(typeof r!="string")throw new TypeError("invalid pattern");if(r.length>65536)throw new TypeError("pattern is too long")};w();w();var Pi={"[:alnum:]":["\\p{L}\\p{Nl}\\p{Nd}",!0],"[:alpha:]":["\\p{L}\\p{Nl}",!0],"[:ascii:]":["\\x00-\\x7f",!1],"[:blank:]":["\\p{Zs}\\t",!0],"[:cntrl:]":["\\p{Cc}",!0],"[:digit:]":["\\p{Nd}",!0],"[:graph:]":["\\p{Z}\\p{C}",!0,!0],"[:lower:]":["\\p{Ll}",!0],"[:print:]":["\\p{C}",!0],"[:punct:]":["\\p{P}",!0],"[:space:]":["\\p{Z}\\t\\r\\n\\v\\f",!0],"[:upper:]":["\\p{Lu}",!0],"[:word:]":["\\p{L}\\p{Nl}\\p{Nd}\\p{Pc}",!0],"[:xdigit:]":["A-Fa-f0-9",!1]},St=r=>r.replace(/[[\]\\-]/g,"\\$&"),Ii=r=>r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),os=r=>r.join(""),hs=(r,t)=>{let e=t;if(r.charAt(e)!=="[")throw new Error("not in a brace expression");let s=[],i=[],n=e+1,o=!1,h=!1,a=!1,l=!1,c=e,f="";t:for(;n<r.length;){let p=r.charAt(n);if((p==="!"||p==="^")&&n===e+1){l=!0,n++;continue}if(p==="]"&&o&&!a){c=n+1;break}if(o=!0,p==="\\"&&!a){a=!0,n++;continue}if(p==="["&&!a){for(let[b,[g,S,E]]of Object.entries(Pi))if(r.startsWith(b,n)){if(f)return["$.",!1,r.length-e,!0];n+=b.length,E?i.push(g):s.push(g),h=h||S;continue t}}if(a=!1,f){p>f?s.push(St(f)+"-"+St(p)):p===f&&s.push(St(p)),f="",n++;continue}if(r.startsWith("-]",n+1)){s.push(St(p+"-")),n+=2;continue}if(r.startsWith("-",n+1)){f=p,n+=2;continue}s.push(St(p)),n++}if(c<n)return["",!1,0,!1];if(!s.length&&!i.length)return["$.",!1,r.length-e,!0];if(i.length===0&&s.length===1&&/^\\?.$/.test(s[0])&&!l){let p=s[0].length===2?s[0].slice(-1):s[0];return[Ii(p),!1,c-e,!1]}let u="["+(l?"^":"")+os(s)+"]",d="["+(l?"":"^")+os(i)+"]";return[s.length&&i.length?"("+u+"|"+d+")":s.length?u:d,h,c-e,!0]};w();var G=(r,{windowsPathsNoEscape:t=!1}={})=>t?r.replace(/\[([^\/\\])\]/g,"$1"):r.replace(/((?!\\).|^)\[([^\/\\])\]/g,"$1$2").replace(/\\([^\/])/g,"$1");var Mi=new Set(["!","?","+","*","@"]),as=r=>Mi.has(r),_i="(?!(?:^|/)\\.\\.?(?:$|/))",jt="(?!\\.)",Fi=new Set(["[","."]),Di=new Set(["..","."]),Li=new Set("().*{}+?[]^$\\!"),ji=r=>r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),be="[^/]",ls=be+"*?",cs=be+"+?",ot=class r{type;#t;#e;#n=!1;#i=[];#o;#S;#l;#f=!1;#h;#a;#r=!1;constructor(t,e,s={}){this.type=t,t&&(this.#e=!0),this.#o=e,this.#t=this.#o?this.#o.#t:this,this.#h=this.#t===this?s:this.#t.#h,this.#l=this.#t===this?[]:this.#t.#l,t==="!"&&!this.#t.#f&&this.#l.push(this),this.#S=this.#o?this.#o.#i.length:0}get hasMagic(){if(this.#e!==void 0)return this.#e;for(let t of this.#i)if(typeof t!="string"&&(t.type||t.hasMagic))return this.#e=!0;return this.#e}toString(){return this.#a!==void 0?this.#a:this.type?this.#a=this.type+"("+this.#i.map(t=>String(t)).join("|")+")":this.#a=this.#i.map(t=>String(t)).join("")}#g(){if(this!==this.#t)throw new Error("should only call on root");if(this.#f)return this;this.toString(),this.#f=!0;let t;for(;t=this.#l.pop();){if(t.type!=="!")continue;let e=t,s=e.#o;for(;s;){for(let i=e.#S+1;!s.type&&i<s.#i.length;i++)for(let n of t.#i){if(typeof n=="string")throw new Error("string part in extglob AST??");n.copyIn(s.#i[i])}e=s,s=e.#o}}return this}push(...t){for(let e of t)if(e!==""){if(typeof e!="string"&&!(e instanceof r&&e.#o===this))throw new Error("invalid part: "+e);this.#i.push(e)}}toJSON(){let t=this.type===null?this.#i.slice().map(e=>typeof e=="string"?e:e.toJSON()):[this.type,...this.#i.map(e=>e.toJSON())];return this.isStart()&&!this.type&&t.unshift([]),this.isEnd()&&(this===this.#t||this.#t.#f&&this.#o?.type==="!")&&t.push({}),t}isStart(){if(this.#t===this)return!0;if(!this.#o?.isStart())return!1;if(this.#S===0)return!0;let t=this.#o;for(let e=0;e<this.#S;e++){let s=t.#i[e];if(!(s instanceof r&&s.type==="!"))return!1}return!0}isEnd(){if(this.#t===this||this.#o?.type==="!")return!0;if(!this.#o?.isEnd())return!1;if(!this.type)return this.#o?.isEnd();let t=this.#o?this.#o.#i.length:0;return this.#S===t-1}copyIn(t){typeof t=="string"?this.push(t):this.push(t.clone(this))}clone(t){let e=new r(this.type,t);for(let s of this.#i)e.copyIn(s);return e}static#w(t,e,s,i){let n=!1,o=!1,h=-1,a=!1;if(e.type===null){let d=s,m="";for(;d<t.length;){let p=t.charAt(d++);if(n||p==="\\"){n=!n,m+=p;continue}if(o){d===h+1?(p==="^"||p==="!")&&(a=!0):p==="]"&&!(d===h+2&&a)&&(o=!1),m+=p;continue}else if(p==="["){o=!0,h=d,a=!1,m+=p;continue}if(!i.noext&&as(p)&&t.charAt(d)==="("){e.push(m),m="";let b=new r(p,e);d=r.#w(t,b,d,i),e.push(b);continue}m+=p}return e.push(m),d}let l=s+1,c=new r(null,e),f=[],u="";for(;l<t.length;){let d=t.charAt(l++);if(n||d==="\\"){n=!n,u+=d;continue}if(o){l===h+1?(d==="^"||d==="!")&&(a=!0):d==="]"&&!(l===h+2&&a)&&(o=!1),u+=d;continue}else if(d==="["){o=!0,h=l,a=!1,u+=d;continue}if(as(d)&&t.charAt(l)==="("){c.push(u),u="";let m=new r(d,c);c.push(m),l=r.#w(t,m,l,i);continue}if(d==="|"){c.push(u),u="",f.push(c),c=new r(null,e);continue}if(d===")")return u===""&&e.#i.length===0&&(e.#r=!0),c.push(u),u="",e.push(...f,c),l;u+=d}return e.type=null,e.#e=void 0,e.#i=[t.substring(s-1)],l}static fromGlob(t,e={}){let s=new r(null,void 0,e);return r.#w(t,s,0,e),s}toMMPattern(){if(this!==this.#t)return this.#t.toMMPattern();let t=this.toString(),[e,s,i,n]=this.toRegExpSource();if(!(i||this.#e||this.#h.nocase&&!this.#h.nocaseMagicOnly&&t.toUpperCase()!==t.toLowerCase()))return s;let h=(this.#h.nocase?"i":"")+(n?"u":"");return Object.assign(new RegExp(`^${e}$`,h),{_src:e,_glob:t})}get options(){return this.#h}toRegExpSource(t){let e=t??!!this.#h.dot;if(this.#t===this&&this.#g(),!this.type){let a=this.isStart()&&this.isEnd(),l=this.#i.map(d=>{let[m,p,b,g]=typeof d=="string"?r.#u(d,this.#e,a):d.toRegExpSource(t);return this.#e=this.#e||b,this.#n=this.#n||g,m}).join(""),c="";if(this.isStart()&&typeof this.#i[0]=="string"&&!(this.#i.length===1&&Di.has(this.#i[0]))){let m=Fi,p=e&&m.has(l.charAt(0))||l.startsWith("\\.")&&m.has(l.charAt(2))||l.startsWith("\\.\\.")&&m.has(l.charAt(4)),b=!e&&!t&&m.has(l.charAt(0));c=p?_i:b?jt:""}let f="";return this.isEnd()&&this.#t.#f&&this.#o?.type==="!"&&(f="(?:$|\\/)"),[c+l+f,G(l),this.#e=!!this.#e,this.#n]}let s=this.type==="*"||this.type==="+",i=this.type==="!"?"(?:(?!(?:":"(?:",n=this.#d(e);if(this.isStart()&&this.isEnd()&&!n&&this.type!=="!"){let a=this.toString();return this.#i=[a],this.type=null,this.#e=void 0,[a,G(this.toString()),!1,!1]}let o=!s||t||e||!jt?"":this.#d(!0);o===n&&(o=""),o&&(n=`(?:${n})(?:${o})*?`);let h="";if(this.type==="!"&&this.#r)h=(this.isStart()&&!e?jt:"")+cs;else{let a=this.type==="!"?"))"+(this.isStart()&&!e&&!t?jt:"")+ls+")":this.type==="@"?")":this.type==="?"?")?":this.type==="+"&&o?")":this.type==="*"&&o?")?":`)${this.type}`;h=i+n+a}return[h,G(n),this.#e=!!this.#e,this.#n]}#d(t){return this.#i.map(e=>{if(typeof e=="string")throw new Error("string type in extglob ast??");let[s,i,n,o]=e.toRegExpSource(t);return this.#n=this.#n||o,s}).filter(e=>!(this.isStart()&&this.isEnd())||!!e).join("|")}static#u(t,e,s=!1){let i=!1,n="",o=!1;for(let h=0;h<t.length;h++){let a=t.charAt(h);if(i){i=!1,n+=(Li.has(a)?"\\":"")+a;continue}if(a==="\\"){h===t.length-1?n+="\\\\":i=!0;continue}if(a==="["){let[l,c,f,u]=hs(t,h);if(f){n+=l,o=o||c,h+=f-1,e=e||u;continue}}if(a==="*"){s&&t==="*"?n+=cs:n+=ls,e=!0;continue}if(a==="?"){n+=be,e=!0;continue}n+=ji(a)}return[n,G(t),!!e,o]}};w();var ht=(r,{windowsPathsNoEscape:t=!1}={})=>t?r.replace(/[?*()[\]]/g,"[$&]"):r.replace(/[?*()[\]\\]/g,"\\$&");var I=(r,t,e={})=>(yt(t),!e.nocomment&&t.charAt(0)==="#"?!1:new _(t,e).match(r)),Ui=/^\*+([^+@!?\*\[\(]*)$/,Wi=r=>t=>!t.startsWith(".")&&t.endsWith(r),zi=r=>t=>t.endsWith(r),$i=r=>(r=r.toLowerCase(),t=>!t.startsWith(".")&&t.toLowerCase().endsWith(r)),Gi=r=>(r=r.toLowerCase(),t=>t.toLowerCase().endsWith(r)),qi=/^\*+\.\*+$/,Hi=r=>!r.startsWith(".")&&r.includes("."),Ki=r=>r!=="."&&r!==".."&&r.includes("."),Yi=/^\.\*+$/,Vi=r=>r!=="."&&r!==".."&&r.startsWith("."),Zi=/^\*+$/,Qi=r=>r.length!==0&&!r.startsWith("."),Ji=r=>r.length!==0&&r!=="."&&r!=="..",Xi=/^\?+([^+@!?\*\[\(]*)?$/,tr=([r,t=""])=>{let e=ps([r]);return t?(t=t.toLowerCase(),s=>e(s)&&s.toLowerCase().endsWith(t)):e},er=([r,t=""])=>{let e=ms([r]);return t?(t=t.toLowerCase(),s=>e(s)&&s.toLowerCase().endsWith(t)):e},sr=([r,t=""])=>{let e=ms([r]);return t?s=>e(s)&&s.endsWith(t):e},ir=([r,t=""])=>{let e=ps([r]);return t?s=>e(s)&&s.endsWith(t):e},ps=([r])=>{let t=r.length;return e=>e.length===t&&!e.startsWith(".")},ms=([r])=>{let t=r.length;return e=>e.length===t&&e!=="."&&e!==".."},gs=typeof process=="object"&&process?typeof process.env=="object"&&process.env&&process.env.__MINIMATCH_TESTING_PLATFORM__||process.platform:"posix",fs={win32:{sep:"\\"},posix:{sep:"/"}},rr=gs==="win32"?fs.win32.sep:fs.posix.sep;I.sep=rr;var N=Symbol("globstar **");I.GLOBSTAR=N;var nr="[^/]",or=nr+"*?",hr="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",ar="(?:(?!(?:\\/|^)\\.).)*?",lr=(r,t={})=>e=>I(e,r,t);I.filter=lr;var L=(r,t={})=>Object.assign({},r,t),cr=r=>{if(!r||typeof r!="object"||!Object.keys(r).length)return I;let t=I;return Object.assign((s,i,n={})=>t(s,i,L(r,n)),{Minimatch:class extends t.Minimatch{constructor(i,n={}){super(i,L(r,n))}static defaults(i){return t.defaults(L(r,i)).Minimatch}},AST:class extends t.AST{constructor(i,n,o={}){super(i,n,L(r,o))}static fromGlob(i,n={}){return t.AST.fromGlob(i,L(r,n))}},unescape:(s,i={})=>t.unescape(s,L(r,i)),escape:(s,i={})=>t.escape(s,L(r,i)),filter:(s,i={})=>t.filter(s,L(r,i)),defaults:s=>t.defaults(L(r,s)),makeRe:(s,i={})=>t.makeRe(s,L(r,i)),braceExpand:(s,i={})=>t.braceExpand(s,L(r,i)),match:(s,i,n={})=>t.match(s,i,L(r,n)),sep:t.sep,GLOBSTAR:N})};I.defaults=cr;var ws=(r,t={})=>(yt(r),t.nobrace||!/\{(?:(?!\{).)*\}/.test(r)?[r]:(0,ds.default)(r));I.braceExpand=ws;var fr=(r,t={})=>new _(r,t).makeRe();I.makeRe=fr;var ur=(r,t,e={})=>{let s=new _(t,e);return r=r.filter(i=>s.match(i)),s.options.nonull&&!r.length&&r.push(t),r};I.match=ur;var us=/[?*]|[+@!]\(.*?\)|\[|\]/,dr=r=>r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),_=class{options;set;pattern;windowsPathsNoEscape;nonegate;negate;comment;empty;preserveMultipleSlashes;partial;globSet;globParts;nocase;isWindows;platform;windowsNoMagicRoot;regexp;constructor(t,e={}){yt(t),e=e||{},this.options=e,this.pattern=t,this.platform=e.platform||gs,this.isWindows=this.platform==="win32",this.windowsPathsNoEscape=!!e.windowsPathsNoEscape||e.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.preserveMultipleSlashes=!!e.preserveMultipleSlashes,this.regexp=null,this.negate=!1,this.nonegate=!!e.nonegate,this.comment=!1,this.empty=!1,this.partial=!!e.partial,this.nocase=!!this.options.nocase,this.windowsNoMagicRoot=e.windowsNoMagicRoot!==void 0?e.windowsNoMagicRoot:!!(this.isWindows&&this.nocase),this.globSet=[],this.globParts=[],this.set=[],this.make()}hasMagic(){if(this.options.magicalBraces&&this.set.length>1)return!0;for(let t of this.set)for(let e of t)if(typeof e!="string")return!0;return!1}debug(...t){}make(){let t=this.pattern,e=this.options;if(!e.nocomment&&t.charAt(0)==="#"){this.comment=!0;return}if(!t){this.empty=!0;return}this.parseNegate(),this.globSet=[...new Set(this.braceExpand())],e.debug&&(this.debug=(...n)=>console.error(...n)),this.debug(this.pattern,this.globSet);let s=this.globSet.map(n=>this.slashSplit(n));this.globParts=this.preprocess(s),this.debug(this.pattern,this.globParts);let i=this.globParts.map((n,o,h)=>{if(this.isWindows&&this.windowsNoMagicRoot){let a=n[0]===""&&n[1]===""&&(n[2]==="?"||!us.test(n[2]))&&!us.test(n[3]),l=/^[a-z]:/i.test(n[0]);if(a)return[...n.slice(0,4),...n.slice(4).map(c=>this.parse(c))];if(l)return[n[0],...n.slice(1).map(c=>this.parse(c))]}return n.map(a=>this.parse(a))});if(this.debug(this.pattern,i),this.set=i.filter(n=>n.indexOf(!1)===-1),this.isWindows)for(let n=0;n<this.set.length;n++){let o=this.set[n];o[0]===""&&o[1]===""&&this.globParts[n][2]==="?"&&typeof o[3]=="string"&&/^[a-z]:$/i.test(o[3])&&(o[2]="?")}this.debug(this.pattern,this.set)}preprocess(t){if(this.options.noglobstar)for(let s=0;s<t.length;s++)for(let i=0;i<t[s].length;i++)t[s][i]==="**"&&(t[s][i]="*");let{optimizationLevel:e=1}=this.options;return e>=2?(t=this.firstPhasePreProcess(t),t=this.secondPhasePreProcess(t)):e>=1?t=this.levelOneOptimize(t):t=this.adjascentGlobstarOptimize(t),t}adjascentGlobstarOptimize(t){return t.map(e=>{let s=-1;for(;(s=e.indexOf("**",s+1))!==-1;){let i=s;for(;e[i+1]==="**";)i++;i!==s&&e.splice(s,i-s)}return e})}levelOneOptimize(t){return t.map(e=>(e=e.reduce((s,i)=>{let n=s[s.length-1];return i==="**"&&n==="**"?s:i===".."&&n&&n!==".."&&n!=="."&&n!=="**"?(s.pop(),s):(s.push(i),s)},[]),e.length===0?[""]:e))}levelTwoFileOptimize(t){Array.isArray(t)||(t=this.slashSplit(t));let e=!1;do{if(e=!1,!this.preserveMultipleSlashes){for(let i=1;i<t.length-1;i++){let n=t[i];i===1&&n===""&&t[0]===""||(n==="."||n==="")&&(e=!0,t.splice(i,1),i--)}t[0]==="."&&t.length===2&&(t[1]==="."||t[1]==="")&&(e=!0,t.pop())}let s=0;for(;(s=t.indexOf("..",s+1))!==-1;){let i=t[s-1];i&&i!=="."&&i!==".."&&i!=="**"&&(e=!0,t.splice(s-1,2),s-=2)}}while(e);return t.length===0?[""]:t}firstPhasePreProcess(t){let e=!1;do{e=!1;for(let s of t){let i=-1;for(;(i=s.indexOf("**",i+1))!==-1;){let o=i;for(;s[o+1]==="**";)o++;o>i&&s.splice(i+1,o-i);let h=s[i+1],a=s[i+2],l=s[i+3];if(h!==".."||!a||a==="."||a===".."||!l||l==="."||l==="..")continue;e=!0,s.splice(i,1);let c=s.slice(0);c[i]="**",t.push(c),i--}if(!this.preserveMultipleSlashes){for(let o=1;o<s.length-1;o++){let h=s[o];o===1&&h===""&&s[0]===""||(h==="."||h==="")&&(e=!0,s.splice(o,1),o--)}s[0]==="."&&s.length===2&&(s[1]==="."||s[1]==="")&&(e=!0,s.pop())}let n=0;for(;(n=s.indexOf("..",n+1))!==-1;){let o=s[n-1];if(o&&o!=="."&&o!==".."&&o!=="**"){e=!0;let a=n===1&&s[n+1]==="**"?["."]:[];s.splice(n-1,2,...a),s.length===0&&s.push(""),n-=2}}}}while(e);return t}secondPhasePreProcess(t){for(let e=0;e<t.length-1;e++)for(let s=e+1;s<t.length;s++){let i=this.partsMatch(t[e],t[s],!this.preserveMultipleSlashes);if(i){t[e]=[],t[s]=i;break}}return t.filter(e=>e.length)}partsMatch(t,e,s=!1){let i=0,n=0,o=[],h="";for(;i<t.length&&n<e.length;)if(t[i]===e[n])o.push(h==="b"?e[n]:t[i]),i++,n++;else if(s&&t[i]==="**"&&e[n]===t[i+1])o.push(t[i]),i++;else if(s&&e[n]==="**"&&t[i]===e[n+1])o.push(e[n]),n++;else if(t[i]==="*"&&e[n]&&(this.options.dot||!e[n].startsWith("."))&&e[n]!=="**"){if(h==="b")return!1;h="a",o.push(t[i]),i++,n++}else if(e[n]==="*"&&t[i]&&(this.options.dot||!t[i].startsWith("."))&&t[i]!=="**"){if(h==="a")return!1;h="b",o.push(e[n]),i++,n++}else return!1;return t.length===e.length&&o}parseNegate(){if(this.nonegate)return;let t=this.pattern,e=!1,s=0;for(let i=0;i<t.length&&t.charAt(i)==="!";i++)e=!e,s++;s&&(this.pattern=t.slice(s)),this.negate=e}matchOne(t,e,s=!1){let i=this.options;if(this.isWindows){let p=typeof t[0]=="string"&&/^[a-z]:$/i.test(t[0]),b=!p&&t[0]===""&&t[1]===""&&t[2]==="?"&&/^[a-z]:$/i.test(t[3]),g=typeof e[0]=="string"&&/^[a-z]:$/i.test(e[0]),S=!g&&e[0]===""&&e[1]===""&&e[2]==="?"&&typeof e[3]=="string"&&/^[a-z]:$/i.test(e[3]),E=b?3:p?0:void 0,y=S?3:g?0:void 0;if(typeof E=="number"&&typeof y=="number"){let[v,A]=[t[E],e[y]];v.toLowerCase()===A.toLowerCase()&&(e[y]=v,y>E?e=e.slice(y):E>y&&(t=t.slice(E)))}}let{optimizationLevel:n=1}=this.options;n>=2&&(t=this.levelTwoFileOptimize(t)),this.debug("matchOne",this,{file:t,pattern:e}),this.debug("matchOne",t.length,e.length);for(var o=0,h=0,a=t.length,l=e.length;o<a&&h<l;o++,h++){this.debug("matchOne loop");var c=e[h],f=t[o];if(this.debug(e,c,f),c===!1)return!1;if(c===N){this.debug("GLOBSTAR",[e,c,f]);var u=o,d=h+1;if(d===l){for(this.debug("** at the end");o<a;o++)if(t[o]==="."||t[o]===".."||!i.dot&&t[o].charAt(0)===".")return!1;return!0}for(;u<a;){var m=t[u];if(this.debug(`
globstar while`,t,u,e,d,m),this.matchOne(t.slice(u),e.slice(d),s))return this.debug("globstar found match!",u,a,m),!0;if(m==="."||m===".."||!i.dot&&m.charAt(0)==="."){this.debug("dot detected!",t,u,e,d);break}this.debug("globstar swallow a segment, and continue"),u++}return!!(s&&(this.debug(`
>>> no match, partial?`,t,u,e,d),u===a))}let p;if(typeof c=="string"?(p=f===c,this.debug("string match",c,f,p)):(p=c.test(f),this.debug("pattern match",c,f,p)),!p)return!1}if(o===a&&h===l)return!0;if(o===a)return s;if(h===l)return o===a-1&&t[o]==="";throw new Error("wtf?")}braceExpand(){return ws(this.pattern,this.options)}parse(t){yt(t);let e=this.options;if(t==="**")return N;if(t==="")return"";let s,i=null;(s=t.match(Zi))?i=e.dot?Ji:Qi:(s=t.match(Ui))?i=(e.nocase?e.dot?Gi:$i:e.dot?zi:Wi)(s[1]):(s=t.match(Xi))?i=(e.nocase?e.dot?er:tr:e.dot?sr:ir)(s):(s=t.match(qi))?i=e.dot?Ki:Hi:(s=t.match(Yi))&&(i=Vi);let n=ot.fromGlob(t,this.options).toMMPattern();return i&&typeof n=="object"&&Reflect.defineProperty(n,"test",{value:i}),n}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;let t=this.set;if(!t.length)return this.regexp=!1,this.regexp;let e=this.options,s=e.noglobstar?or:e.dot?hr:ar,i=new Set(e.nocase?["i"]:[]),n=t.map(a=>{let l=a.map(c=>{if(c instanceof RegExp)for(let f of c.flags.split(""))i.add(f);return typeof c=="string"?dr(c):c===N?N:c._src});return l.forEach((c,f)=>{let u=l[f+1],d=l[f-1];c!==N||d===N||(d===void 0?u!==void 0&&u!==N?l[f+1]="(?:\\/|"+s+"\\/)?"+u:l[f]=s:u===void 0?l[f-1]=d+"(?:\\/|"+s+")?":u!==N&&(l[f-1]=d+"(?:\\/|\\/"+s+"\\/)"+u,l[f+1]=N))}),l.filter(c=>c!==N).join("/")}).join("|"),[o,h]=t.length>1?["(?:",")"]:["",""];n="^"+o+n+h+"$",this.negate&&(n="^(?!"+n+").+$");try{this.regexp=new RegExp(n,[...i].join(""))}catch{this.regexp=!1}return this.regexp}slashSplit(t){return this.preserveMultipleSlashes?t.split("/"):this.isWindows&&/^\/\/[^\/]+/.test(t)?["",...t.split(/\/+/)]:t.split(/\/+/)}match(t,e=this.partial){if(this.debug("match",t,this.pattern),this.comment)return!1;if(this.empty)return t==="";if(t==="/"&&e)return!0;let s=this.options;this.isWindows&&(t=t.split("\\").join("/"));let i=this.slashSplit(t);this.debug(this.pattern,"split",i);let n=this.set;this.debug(this.pattern,"set",n);let o=i[i.length-1];if(!o)for(let h=i.length-2;!o&&h>=0;h--)o=i[h];for(let h=0;h<n.length;h++){let a=n[h],l=i;if(s.matchBase&&a.length===1&&(l=[o]),this.matchOne(l,a,e))return s.flipNegate?!0:!this.negate}return s.flipNegate?!1:this.negate}static defaults(t){return I.defaults(t).Minimatch}};I.AST=ot;I.Minimatch=_;I.escape=ht;I.unescape=G;w();import{fileURLToPath as qr}from"node:url";w();w();var at=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,ys=new Set,ye=typeof process=="object"&&process?process:{},Ss=(r,t,e,s)=>{typeof ye.emitWarning=="function"?ye.emitWarning(r,t,e,s):console.error(`[${e}] ${t}: ${r}`)},Ut=globalThis.AbortController,bs=globalThis.AbortSignal;if(typeof Ut>"u"){bs=class{onabort;_onabort=[];reason;aborted=!1;addEventListener(s,i){this._onabort.push(i)}},Ut=class{constructor(){t()}signal=new bs;abort(s){if(!this.signal.aborted){this.signal.reason=s,this.signal.aborted=!0;for(let i of this.signal._onabort)i(s);this.signal.onabort?.(s)}}};let r=ye.env?.LRU_CACHE_IGNORE_AC_WARNING!=="1",t=()=>{r&&(r=!1,Ss("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",t))}}var pr=r=>!ys.has(r),co=Symbol("type"),X=r=>r&&r===Math.floor(r)&&r>0&&isFinite(r),Es=r=>X(r)?r<=Math.pow(2,8)?Uint8Array:r<=Math.pow(2,16)?Uint16Array:r<=Math.pow(2,32)?Uint32Array:r<=Number.MAX_SAFE_INTEGER?lt:null:null,lt=class extends Array{constructor(t){super(t),this.fill(0)}},Se=class r{heap;length;static#t=!1;static create(t){let e=Es(t);if(!e)return[];r.#t=!0;let s=new r(t,e);return r.#t=!1,s}constructor(t,e){if(!r.#t)throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new e(t),this.length=0}push(t){this.heap[this.length++]=t}pop(){return this.heap[--this.length]}},Et=class r{#t;#e;#n;#i;#o;#S;ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#l;#f;#h;#a;#r;#g;#w;#d;#u;#x;#m;#C;#T;#y;#E;#v;#p;static unsafeExposeInternals(t){return{starts:t.#T,ttls:t.#y,sizes:t.#C,keyMap:t.#h,keyList:t.#a,valList:t.#r,next:t.#g,prev:t.#w,get head(){return t.#d},get tail(){return t.#u},free:t.#x,isBackgroundFetch:e=>t.#c(e),backgroundFetch:(e,s,i,n)=>t.#L(e,s,i,n),moveToTail:e=>t.#U(e),indexes:e=>t.#k(e),rindexes:e=>t.#O(e),isStale:e=>t.#b(e)}}get max(){return this.#t}get maxSize(){return this.#e}get calculatedSize(){return this.#f}get size(){return this.#l}get fetchMethod(){return this.#o}get memoMethod(){return this.#S}get dispose(){return this.#n}get disposeAfter(){return this.#i}constructor(t){let{max:e=0,ttl:s,ttlResolution:i=1,ttlAutopurge:n,updateAgeOnGet:o,updateAgeOnHas:h,allowStale:a,dispose:l,disposeAfter:c,noDisposeOnSet:f,noUpdateTTL:u,maxSize:d=0,maxEntrySize:m=0,sizeCalculation:p,fetchMethod:b,memoMethod:g,noDeleteOnFetchRejection:S,noDeleteOnStaleGet:E,allowStaleOnFetchRejection:y,allowStaleOnFetchAbort:v,ignoreFetchAbort:A}=t;if(e!==0&&!X(e))throw new TypeError("max option must be a nonnegative integer");let z=e?Es(e):Array;if(!z)throw new Error("invalid max value: "+e);if(this.#t=e,this.#e=d,this.maxEntrySize=m||this.#e,this.sizeCalculation=p,this.sizeCalculation){if(!this.#e&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(g!==void 0&&typeof g!="function")throw new TypeError("memoMethod must be a function if defined");if(this.#S=g,b!==void 0&&typeof b!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.#o=b,this.#v=!!b,this.#h=new Map,this.#a=new Array(e).fill(void 0),this.#r=new Array(e).fill(void 0),this.#g=new z(e),this.#w=new z(e),this.#d=0,this.#u=0,this.#x=Se.create(e),this.#l=0,this.#f=0,typeof l=="function"&&(this.#n=l),typeof c=="function"?(this.#i=c,this.#m=[]):(this.#i=void 0,this.#m=void 0),this.#E=!!this.#n,this.#p=!!this.#i,this.noDisposeOnSet=!!f,this.noUpdateTTL=!!u,this.noDeleteOnFetchRejection=!!S,this.allowStaleOnFetchRejection=!!y,this.allowStaleOnFetchAbort=!!v,this.ignoreFetchAbort=!!A,this.maxEntrySize!==0){if(this.#e!==0&&!X(this.#e))throw new TypeError("maxSize must be a positive integer if specified");if(!X(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.#N()}if(this.allowStale=!!a,this.noDeleteOnStaleGet=!!E,this.updateAgeOnGet=!!o,this.updateAgeOnHas=!!h,this.ttlResolution=X(i)||i===0?i:1,this.ttlAutopurge=!!n,this.ttl=s||0,this.ttl){if(!X(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.#R()}if(this.#t===0&&this.ttl===0&&this.#e===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#t&&!this.#e){let it="LRU_CACHE_UNBOUNDED";pr(it)&&(ys.add(it),Ss("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",it,r))}}getRemainingTTL(t){return this.#h.has(t)?1/0:0}#R(){let t=new lt(this.#t),e=new lt(this.#t);this.#y=t,this.#T=e,this.#P=(n,o,h=at.now())=>{if(e[n]=o!==0?h:0,t[n]=o,o!==0&&this.ttlAutopurge){let a=setTimeout(()=>{this.#b(n)&&this.#B(this.#a[n],"expire")},o+1);a.unref&&a.unref()}},this.#A=n=>{e[n]=t[n]!==0?at.now():0},this.#s=(n,o)=>{if(t[o]){let h=t[o],a=e[o];if(!h||!a)return;n.ttl=h,n.start=a,n.now=s||i();let l=n.now-a;n.remainingTTL=h-l}};let s=0,i=()=>{let n=at.now();if(this.ttlResolution>0){s=n;let o=setTimeout(()=>s=0,this.ttlResolution);o.unref&&o.unref()}return n};this.getRemainingTTL=n=>{let o=this.#h.get(n);if(o===void 0)return 0;let h=t[o],a=e[o];if(!h||!a)return 1/0;let l=(s||i())-a;return h-l},this.#b=n=>{let o=e[n],h=t[n];return!!h&&!!o&&(s||i())-o>h}}#A=()=>{};#s=()=>{};#P=()=>{};#b=()=>!1;#N(){let t=new lt(this.#t);this.#f=0,this.#C=t,this.#I=e=>{this.#f-=t[e],t[e]=0},this.#_=(e,s,i,n)=>{if(this.#c(s))return 0;if(!X(i))if(n){if(typeof n!="function")throw new TypeError("sizeCalculation must be a function");if(i=n(s,e),!X(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return i},this.#M=(e,s,i)=>{if(t[e]=s,this.#e){let n=this.#e-t[e];for(;this.#f>n;)this.#D(!0)}this.#f+=t[e],i&&(i.entrySize=s,i.totalCalculatedSize=this.#f)}}#I=t=>{};#M=(t,e,s)=>{};#_=(t,e,s,i)=>{if(s||i)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0};*#k({allowStale:t=this.allowStale}={}){if(this.#l)for(let e=this.#u;!(!this.#F(e)||((t||!this.#b(e))&&(yield e),e===this.#d));)e=this.#w[e]}*#O({allowStale:t=this.allowStale}={}){if(this.#l)for(let e=this.#d;!(!this.#F(e)||((t||!this.#b(e))&&(yield e),e===this.#u));)e=this.#g[e]}#F(t){return t!==void 0&&this.#h.get(this.#a[t])===t}*entries(){for(let t of this.#k())this.#r[t]!==void 0&&this.#a[t]!==void 0&&!this.#c(this.#r[t])&&(yield[this.#a[t],this.#r[t]])}*rentries(){for(let t of this.#O())this.#r[t]!==void 0&&this.#a[t]!==void 0&&!this.#c(this.#r[t])&&(yield[this.#a[t],this.#r[t]])}*keys(){for(let t of this.#k()){let e=this.#a[t];e!==void 0&&!this.#c(this.#r[t])&&(yield e)}}*rkeys(){for(let t of this.#O()){let e=this.#a[t];e!==void 0&&!this.#c(this.#r[t])&&(yield e)}}*values(){for(let t of this.#k())this.#r[t]!==void 0&&!this.#c(this.#r[t])&&(yield this.#r[t])}*rvalues(){for(let t of this.#O())this.#r[t]!==void 0&&!this.#c(this.#r[t])&&(yield this.#r[t])}[Symbol.iterator](){return this.entries()}[Symbol.toStringTag]="LRUCache";find(t,e={}){for(let s of this.#k()){let i=this.#r[s],n=this.#c(i)?i.__staleWhileFetching:i;if(n!==void 0&&t(n,this.#a[s],this))return this.get(this.#a[s],e)}}forEach(t,e=this){for(let s of this.#k()){let i=this.#r[s],n=this.#c(i)?i.__staleWhileFetching:i;n!==void 0&&t.call(e,n,this.#a[s],this)}}rforEach(t,e=this){for(let s of this.#O()){let i=this.#r[s],n=this.#c(i)?i.__staleWhileFetching:i;n!==void 0&&t.call(e,n,this.#a[s],this)}}purgeStale(){let t=!1;for(let e of this.#O({allowStale:!0}))this.#b(e)&&(this.#B(this.#a[e],"expire"),t=!0);return t}info(t){let e=this.#h.get(t);if(e===void 0)return;let s=this.#r[e],i=this.#c(s)?s.__staleWhileFetching:s;if(i===void 0)return;let n={value:i};if(this.#y&&this.#T){let o=this.#y[e],h=this.#T[e];if(o&&h){let a=o-(at.now()-h);n.ttl=a,n.start=Date.now()}}return this.#C&&(n.size=this.#C[e]),n}dump(){let t=[];for(let e of this.#k({allowStale:!0})){let s=this.#a[e],i=this.#r[e],n=this.#c(i)?i.__staleWhileFetching:i;if(n===void 0||s===void 0)continue;let o={value:n};if(this.#y&&this.#T){o.ttl=this.#y[e];let h=at.now()-this.#T[e];o.start=Math.floor(Date.now()-h)}this.#C&&(o.size=this.#C[e]),t.unshift([s,o])}return t}load(t){this.clear();for(let[e,s]of t){if(s.start){let i=Date.now()-s.start;s.start=at.now()-i}this.set(e,s.value,s)}}set(t,e,s={}){if(e===void 0)return this.delete(t),this;let{ttl:i=this.ttl,start:n,noDisposeOnSet:o=this.noDisposeOnSet,sizeCalculation:h=this.sizeCalculation,status:a}=s,{noUpdateTTL:l=this.noUpdateTTL}=s,c=this.#_(t,e,s.size||0,h);if(this.maxEntrySize&&c>this.maxEntrySize)return a&&(a.set="miss",a.maxEntrySizeExceeded=!0),this.#B(t,"set"),this;let f=this.#l===0?void 0:this.#h.get(t);if(f===void 0)f=this.#l===0?this.#u:this.#x.length!==0?this.#x.pop():this.#l===this.#t?this.#D(!1):this.#l,this.#a[f]=t,this.#r[f]=e,this.#h.set(t,f),this.#g[this.#u]=f,this.#w[f]=this.#u,this.#u=f,this.#l++,this.#M(f,c,a),a&&(a.set="add"),l=!1;else{this.#U(f);let u=this.#r[f];if(e!==u){if(this.#v&&this.#c(u)){u.__abortController.abort(new Error("replaced"));let{__staleWhileFetching:d}=u;d!==void 0&&!o&&(this.#E&&this.#n?.(d,t,"set"),this.#p&&this.#m?.push([d,t,"set"]))}else o||(this.#E&&this.#n?.(u,t,"set"),this.#p&&this.#m?.push([u,t,"set"]));if(this.#I(f),this.#M(f,c,a),this.#r[f]=e,a){a.set="replace";let d=u&&this.#c(u)?u.__staleWhileFetching:u;d!==void 0&&(a.oldValue=d)}}else a&&(a.set="update")}if(i!==0&&!this.#y&&this.#R(),this.#y&&(l||this.#P(f,i,n),a&&this.#s(a,f)),!o&&this.#p&&this.#m){let u=this.#m,d;for(;d=u?.shift();)this.#i?.(...d)}return this}pop(){try{for(;this.#l;){let t=this.#r[this.#d];if(this.#D(!0),this.#c(t)){if(t.__staleWhileFetching)return t.__staleWhileFetching}else if(t!==void 0)return t}}finally{if(this.#p&&this.#m){let t=this.#m,e;for(;e=t?.shift();)this.#i?.(...e)}}}#D(t){let e=this.#d,s=this.#a[e],i=this.#r[e];return this.#v&&this.#c(i)?i.__abortController.abort(new Error("evicted")):(this.#E||this.#p)&&(this.#E&&this.#n?.(i,s,"evict"),this.#p&&this.#m?.push([i,s,"evict"])),this.#I(e),t&&(this.#a[e]=void 0,this.#r[e]=void 0,this.#x.push(e)),this.#l===1?(this.#d=this.#u=0,this.#x.length=0):this.#d=this.#g[e],this.#h.delete(s),this.#l--,e}has(t,e={}){let{updateAgeOnHas:s=this.updateAgeOnHas,status:i}=e,n=this.#h.get(t);if(n!==void 0){let o=this.#r[n];if(this.#c(o)&&o.__staleWhileFetching===void 0)return!1;if(this.#b(n))i&&(i.has="stale",this.#s(i,n));else return s&&this.#A(n),i&&(i.has="hit",this.#s(i,n)),!0}else i&&(i.has="miss");return!1}peek(t,e={}){let{allowStale:s=this.allowStale}=e,i=this.#h.get(t);if(i===void 0||!s&&this.#b(i))return;let n=this.#r[i];return this.#c(n)?n.__staleWhileFetching:n}#L(t,e,s,i){let n=e===void 0?void 0:this.#r[e];if(this.#c(n))return n;let o=new Ut,{signal:h}=s;h?.addEventListener("abort",()=>o.abort(h.reason),{signal:o.signal});let a={signal:o.signal,options:s,context:i},l=(p,b=!1)=>{let{aborted:g}=o.signal,S=s.ignoreFetchAbort&&p!==void 0;if(s.status&&(g&&!b?(s.status.fetchAborted=!0,s.status.fetchError=o.signal.reason,S&&(s.status.fetchAbortIgnored=!0)):s.status.fetchResolved=!0),g&&!S&&!b)return f(o.signal.reason);let E=d;return this.#r[e]===d&&(p===void 0?E.__staleWhileFetching?this.#r[e]=E.__staleWhileFetching:this.#B(t,"fetch"):(s.status&&(s.status.fetchUpdated=!0),this.set(t,p,a.options))),p},c=p=>(s.status&&(s.status.fetchRejected=!0,s.status.fetchError=p),f(p)),f=p=>{let{aborted:b}=o.signal,g=b&&s.allowStaleOnFetchAbort,S=g||s.allowStaleOnFetchRejection,E=S||s.noDeleteOnFetchRejection,y=d;if(this.#r[e]===d&&(!E||y.__staleWhileFetching===void 0?this.#B(t,"fetch"):g||(this.#r[e]=y.__staleWhileFetching)),S)return s.status&&y.__staleWhileFetching!==void 0&&(s.status.returnedStale=!0),y.__staleWhileFetching;if(y.__returned===y)throw p},u=(p,b)=>{let g=this.#o?.(t,n,a);g&&g instanceof Promise&&g.then(S=>p(S===void 0?void 0:S),b),o.signal.addEventListener("abort",()=>{(!s.ignoreFetchAbort||s.allowStaleOnFetchAbort)&&(p(void 0),s.allowStaleOnFetchAbort&&(p=S=>l(S,!0)))})};s.status&&(s.status.fetchDispatched=!0);let d=new Promise(u).then(l,c),m=Object.assign(d,{__abortController:o,__staleWhileFetching:n,__returned:void 0});return e===void 0?(this.set(t,m,{...a.options,status:void 0}),e=this.#h.get(t)):this.#r[e]=m,m}#c(t){if(!this.#v)return!1;let e=t;return!!e&&e instanceof Promise&&e.hasOwnProperty("__staleWhileFetching")&&e.__abortController instanceof Ut}async fetch(t,e={}){let{allowStale:s=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:n=this.noDeleteOnStaleGet,ttl:o=this.ttl,noDisposeOnSet:h=this.noDisposeOnSet,size:a=0,sizeCalculation:l=this.sizeCalculation,noUpdateTTL:c=this.noUpdateTTL,noDeleteOnFetchRejection:f=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:u=this.allowStaleOnFetchRejection,ignoreFetchAbort:d=this.ignoreFetchAbort,allowStaleOnFetchAbort:m=this.allowStaleOnFetchAbort,context:p,forceRefresh:b=!1,status:g,signal:S}=e;if(!this.#v)return g&&(g.fetch="get"),this.get(t,{allowStale:s,updateAgeOnGet:i,noDeleteOnStaleGet:n,status:g});let E={allowStale:s,updateAgeOnGet:i,noDeleteOnStaleGet:n,ttl:o,noDisposeOnSet:h,size:a,sizeCalculation:l,noUpdateTTL:c,noDeleteOnFetchRejection:f,allowStaleOnFetchRejection:u,allowStaleOnFetchAbort:m,ignoreFetchAbort:d,status:g,signal:S},y=this.#h.get(t);if(y===void 0){g&&(g.fetch="miss");let v=this.#L(t,y,E,p);return v.__returned=v}else{let v=this.#r[y];if(this.#c(v)){let Lt=s&&v.__staleWhileFetching!==void 0;return g&&(g.fetch="inflight",Lt&&(g.returnedStale=!0)),Lt?v.__staleWhileFetching:v.__returned=v}let A=this.#b(y);if(!b&&!A)return g&&(g.fetch="hit"),this.#U(y),i&&this.#A(y),g&&this.#s(g,y),v;let z=this.#L(t,y,E,p),$=z.__staleWhileFetching!==void 0&&s;return g&&(g.fetch=A?"stale":"refresh",$&&A&&(g.returnedStale=!0)),$?z.__staleWhileFetching:z.__returned=z}}async forceFetch(t,e={}){let s=await this.fetch(t,e);if(s===void 0)throw new Error("fetch() returned undefined");return s}memo(t,e={}){let s=this.#S;if(!s)throw new Error("no memoMethod provided to constructor");let{context:i,forceRefresh:n,...o}=e,h=this.get(t,o);if(!n&&h!==void 0)return h;let a=s(t,h,{options:o,context:i});return this.set(t,a,o),a}get(t,e={}){let{allowStale:s=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:n=this.noDeleteOnStaleGet,status:o}=e,h=this.#h.get(t);if(h!==void 0){let a=this.#r[h],l=this.#c(a);return o&&this.#s(o,h),this.#b(h)?(o&&(o.get="stale"),l?(o&&s&&a.__staleWhileFetching!==void 0&&(o.returnedStale=!0),s?a.__staleWhileFetching:void 0):(n||this.#B(t,"expire"),o&&s&&(o.returnedStale=!0),s?a:void 0)):(o&&(o.get="hit"),l?a.__staleWhileFetching:(this.#U(h),i&&this.#A(h),a))}else o&&(o.get="miss")}#j(t,e){this.#w[e]=t,this.#g[t]=e}#U(t){t!==this.#u&&(t===this.#d?this.#d=this.#g[t]:this.#j(this.#w[t],this.#g[t]),this.#j(this.#u,t),this.#u=t)}delete(t){return this.#B(t,"delete")}#B(t,e){let s=!1;if(this.#l!==0){let i=this.#h.get(t);if(i!==void 0)if(s=!0,this.#l===1)this.#W(e);else{this.#I(i);let n=this.#r[i];if(this.#c(n)?n.__abortController.abort(new Error("deleted")):(this.#E||this.#p)&&(this.#E&&this.#n?.(n,t,e),this.#p&&this.#m?.push([n,t,e])),this.#h.delete(t),this.#a[i]=void 0,this.#r[i]=void 0,i===this.#u)this.#u=this.#w[i];else if(i===this.#d)this.#d=this.#g[i];else{let o=this.#w[i];this.#g[o]=this.#g[i];let h=this.#g[i];this.#w[h]=this.#w[i]}this.#l--,this.#x.push(i)}}if(this.#p&&this.#m?.length){let i=this.#m,n;for(;n=i?.shift();)this.#i?.(...n)}return s}clear(){return this.#W("delete")}#W(t){for(let e of this.#O({allowStale:!0})){let s=this.#r[e];if(this.#c(s))s.__abortController.abort(new Error("deleted"));else{let i=this.#a[e];this.#E&&this.#n?.(s,i,t),this.#p&&this.#m?.push([s,i,t])}}if(this.#h.clear(),this.#r.fill(void 0),this.#a.fill(void 0),this.#y&&this.#T&&(this.#y.fill(0),this.#T.fill(0)),this.#C&&this.#C.fill(0),this.#d=0,this.#u=0,this.#x.length=0,this.#f=0,this.#l=0,this.#p&&this.#m){let e=this.#m,s;for(;s=e?.shift();)this.#i?.(...s)}}};import{posix as Tr,win32 as Ne}from"node:path";import{fileURLToPath as Ar}from"node:url";import{lstatSync as kr,readdir as Or,readdirSync as Rr,readlinkSync as Nr,realpathSync as Br}from"fs";import*as Pr from"node:fs";import{lstat as Mr,readdir as _r,readlink as Fr,realpath as Dr}from"node:fs/promises";w();import{EventEmitter as ke}from"node:events";import As from"node:stream";import{StringDecoder as mr}from"node:string_decoder";var vs=typeof process=="object"&&process?process:{stdout:null,stderr:null},gr=r=>!!r&&typeof r=="object"&&(r instanceof et||r instanceof As||wr(r)||br(r)),wr=r=>!!r&&typeof r=="object"&&r instanceof ke&&typeof r.pipe=="function"&&r.pipe!==As.Writable.prototype.pipe,br=r=>!!r&&typeof r=="object"&&r instanceof ke&&typeof r.write=="function"&&typeof r.end=="function",Q=Symbol("EOF"),J=Symbol("maybeEmitEnd"),tt=Symbol("emittedEnd"),Wt=Symbol("emittingEnd"),vt=Symbol("emittedError"),zt=Symbol("closed"),xs=Symbol("read"),$t=Symbol("flush"),Cs=Symbol("flushChunk"),q=Symbol("encoding"),ct=Symbol("decoder"),k=Symbol("flowing"),xt=Symbol("paused"),ft=Symbol("resume"),O=Symbol("buffer"),M=Symbol("pipes"),R=Symbol("bufferLength"),Ee=Symbol("bufferPush"),Gt=Symbol("bufferShift"),B=Symbol("objectMode"),T=Symbol("destroyed"),ve=Symbol("error"),xe=Symbol("emitData"),Ts=Symbol("emitEnd"),Ce=Symbol("emitEnd2"),V=Symbol("async"),Te=Symbol("abort"),qt=Symbol("aborted"),Ct=Symbol("signal"),rt=Symbol("dataListeners"),F=Symbol("discarded"),Tt=r=>Promise.resolve().then(r),yr=r=>r(),Sr=r=>r==="end"||r==="finish"||r==="prefinish",Er=r=>r instanceof ArrayBuffer||!!r&&typeof r=="object"&&r.constructor&&r.constructor.name==="ArrayBuffer"&&r.byteLength>=0,vr=r=>!Buffer.isBuffer(r)&&ArrayBuffer.isView(r),Ht=class{src;dest;opts;ondrain;constructor(t,e,s){this.src=t,this.dest=e,this.opts=s,this.ondrain=()=>t[ft](),this.dest.on("drain",this.ondrain)}unpipe(){this.dest.removeListener("drain",this.ondrain)}proxyErrors(t){}end(){this.unpipe(),this.opts.end&&this.dest.end()}},Ae=class extends Ht{unpipe(){this.src.removeListener("error",this.proxyErrors),super.unpipe()}constructor(t,e,s){super(t,e,s),this.proxyErrors=i=>e.emit("error",i),t.on("error",this.proxyErrors)}},xr=r=>!!r.objectMode,Cr=r=>!r.objectMode&&!!r.encoding&&r.encoding!=="buffer",et=class extends ke{[k]=!1;[xt]=!1;[M]=[];[O]=[];[B];[q];[V];[ct];[Q]=!1;[tt]=!1;[Wt]=!1;[zt]=!1;[vt]=null;[R]=0;[T]=!1;[Ct];[qt]=!1;[rt]=0;[F]=!1;writable=!0;readable=!0;constructor(...t){let e=t[0]||{};if(super(),e.objectMode&&typeof e.encoding=="string")throw new TypeError("Encoding and objectMode may not be used together");xr(e)?(this[B]=!0,this[q]=null):Cr(e)?(this[q]=e.encoding,this[B]=!1):(this[B]=!1,this[q]=null),this[V]=!!e.async,this[ct]=this[q]?new mr(this[q]):null,e&&e.debugExposeBuffer===!0&&Object.defineProperty(this,"buffer",{get:()=>this[O]}),e&&e.debugExposePipes===!0&&Object.defineProperty(this,"pipes",{get:()=>this[M]});let{signal:s}=e;s&&(this[Ct]=s,s.aborted?this[Te]():s.addEventListener("abort",()=>this[Te]()))}get bufferLength(){return this[R]}get encoding(){return this[q]}set encoding(t){throw new Error("Encoding must be set at instantiation time")}setEncoding(t){throw new Error("Encoding must be set at instantiation time")}get objectMode(){return this[B]}set objectMode(t){throw new Error("objectMode must be set at instantiation time")}get async(){return this[V]}set async(t){this[V]=this[V]||!!t}[Te](){this[qt]=!0,this.emit("abort",this[Ct]?.reason),this.destroy(this[Ct]?.reason)}get aborted(){return this[qt]}set aborted(t){}write(t,e,s){if(this[qt])return!1;if(this[Q])throw new Error("write after end");if(this[T])return this.emit("error",Object.assign(new Error("Cannot call write after a stream was destroyed"),{code:"ERR_STREAM_DESTROYED"})),!0;typeof e=="function"&&(s=e,e="utf8"),e||(e="utf8");let i=this[V]?Tt:yr;if(!this[B]&&!Buffer.isBuffer(t)){if(vr(t))t=Buffer.from(t.buffer,t.byteOffset,t.byteLength);else if(Er(t))t=Buffer.from(t);else if(typeof t!="string")throw new Error("Non-contiguous data written to non-objectMode stream")}return this[B]?(this[k]&&this[R]!==0&&this[$t](!0),this[k]?this.emit("data",t):this[Ee](t),this[R]!==0&&this.emit("readable"),s&&i(s),this[k]):t.length?(typeof t=="string"&&!(e===this[q]&&!this[ct]?.lastNeed)&&(t=Buffer.from(t,e)),Buffer.isBuffer(t)&&this[q]&&(t=this[ct].write(t)),this[k]&&this[R]!==0&&this[$t](!0),this[k]?this.emit("data",t):this[Ee](t),this[R]!==0&&this.emit("readable"),s&&i(s),this[k]):(this[R]!==0&&this.emit("readable"),s&&i(s),this[k])}read(t){if(this[T])return null;if(this[F]=!1,this[R]===0||t===0||t&&t>this[R])return this[J](),null;this[B]&&(t=null),this[O].length>1&&!this[B]&&(this[O]=[this[q]?this[O].join(""):Buffer.concat(this[O],this[R])]);let e=this[xs](t||null,this[O][0]);return this[J](),e}[xs](t,e){if(this[B])this[Gt]();else{let s=e;t===s.length||t===null?this[Gt]():typeof s=="string"?(this[O][0]=s.slice(t),e=s.slice(0,t),this[R]-=t):(this[O][0]=s.subarray(t),e=s.subarray(0,t),this[R]-=t)}return this.emit("data",e),!this[O].length&&!this[Q]&&this.emit("drain"),e}end(t,e,s){return typeof t=="function"&&(s=t,t=void 0),typeof e=="function"&&(s=e,e="utf8"),t!==void 0&&this.write(t,e),s&&this.once("end",s),this[Q]=!0,this.writable=!1,(this[k]||!this[xt])&&this[J](),this}[ft](){this[T]||(!this[rt]&&!this[M].length&&(this[F]=!0),this[xt]=!1,this[k]=!0,this.emit("resume"),this[O].length?this[$t]():this[Q]?this[J]():this.emit("drain"))}resume(){return this[ft]()}pause(){this[k]=!1,this[xt]=!0,this[F]=!1}get destroyed(){return this[T]}get flowing(){return this[k]}get paused(){return this[xt]}[Ee](t){this[B]?this[R]+=1:this[R]+=t.length,this[O].push(t)}[Gt](){return this[B]?this[R]-=1:this[R]-=this[O][0].length,this[O].shift()}[$t](t=!1){do;while(this[Cs](this[Gt]())&&this[O].length);!t&&!this[O].length&&!this[Q]&&this.emit("drain")}[Cs](t){return this.emit("data",t),this[k]}pipe(t,e){if(this[T])return t;this[F]=!1;let s=this[tt];return e=e||{},t===vs.stdout||t===vs.stderr?e.end=!1:e.end=e.end!==!1,e.proxyErrors=!!e.proxyErrors,s?e.end&&t.end():(this[M].push(e.proxyErrors?new Ae(this,t,e):new Ht(this,t,e)),this[V]?Tt(()=>this[ft]()):this[ft]()),t}unpipe(t){let e=this[M].find(s=>s.dest===t);e&&(this[M].length===1?(this[k]&&this[rt]===0&&(this[k]=!1),this[M]=[]):this[M].splice(this[M].indexOf(e),1),e.unpipe())}addListener(t,e){return this.on(t,e)}on(t,e){let s=super.on(t,e);if(t==="data")this[F]=!1,this[rt]++,!this[M].length&&!this[k]&&this[ft]();else if(t==="readable"&&this[R]!==0)super.emit("readable");else if(Sr(t)&&this[tt])super.emit(t),this.removeAllListeners(t);else if(t==="error"&&this[vt]){let i=e;this[V]?Tt(()=>i.call(this,this[vt])):i.call(this,this[vt])}return s}removeListener(t,e){return this.off(t,e)}off(t,e){let s=super.off(t,e);return t==="data"&&(this[rt]=this.listeners("data").length,this[rt]===0&&!this[F]&&!this[M].length&&(this[k]=!1)),s}removeAllListeners(t){let e=super.removeAllListeners(t);return(t==="data"||t===void 0)&&(this[rt]=0,!this[F]&&!this[M].length&&(this[k]=!1)),e}get emittedEnd(){return this[tt]}[J](){!this[Wt]&&!this[tt]&&!this[T]&&this[O].length===0&&this[Q]&&(this[Wt]=!0,this.emit("end"),this.emit("prefinish"),this.emit("finish"),this[zt]&&this.emit("close"),this[Wt]=!1)}emit(t,...e){let s=e[0];if(t!=="error"&&t!=="close"&&t!==T&&this[T])return!1;if(t==="data")return!this[B]&&!s?!1:this[V]?(Tt(()=>this[xe](s)),!0):this[xe](s);if(t==="end")return this[Ts]();if(t==="close"){if(this[zt]=!0,!this[tt]&&!this[T])return!1;let n=super.emit("close");return this.removeAllListeners("close"),n}else if(t==="error"){this[vt]=s,super.emit(ve,s);let n=!this[Ct]||this.listeners("error").length?super.emit("error",s):!1;return this[J](),n}else if(t==="resume"){let n=super.emit("resume");return this[J](),n}else if(t==="finish"||t==="prefinish"){let n=super.emit(t);return this.removeAllListeners(t),n}let i=super.emit(t,...e);return this[J](),i}[xe](t){for(let s of this[M])s.dest.write(t)===!1&&this.pause();let e=this[F]?!1:super.emit("data",t);return this[J](),e}[Ts](){return this[tt]?!1:(this[tt]=!0,this.readable=!1,this[V]?(Tt(()=>this[Ce]()),!0):this[Ce]())}[Ce](){if(this[ct]){let e=this[ct].end();if(e){for(let s of this[M])s.dest.write(e);this[F]||super.emit("data",e)}}for(let e of this[M])e.end();let t=super.emit("end");return this.removeAllListeners("end"),t}async collect(){let t=Object.assign([],{dataLength:0});this[B]||(t.dataLength=0);let e=this.promise();return this.on("data",s=>{t.push(s),this[B]||(t.dataLength+=s.length)}),await e,t}async concat(){if(this[B])throw new Error("cannot concat in objectMode");let t=await this.collect();return this[q]?t.join(""):Buffer.concat(t,t.dataLength)}async promise(){return new Promise((t,e)=>{this.on(T,()=>e(new Error("stream destroyed"))),this.on("error",s=>e(s)),this.on("end",()=>t())})}[Symbol.asyncIterator](){this[F]=!1;let t=!1,e=async()=>(this.pause(),t=!0,{value:void 0,done:!0});return{next:()=>{if(t)return e();let i=this.read();if(i!==null)return Promise.resolve({done:!1,value:i});if(this[Q])return e();let n,o,h=f=>{this.off("data",a),this.off("end",l),this.off(T,c),e(),o(f)},a=f=>{this.off("error",h),this.off("end",l),this.off(T,c),this.pause(),n({value:f,done:!!this[Q]})},l=()=>{this.off("error",h),this.off("data",a),this.off(T,c),e(),n({done:!0,value:void 0})},c=()=>h(new Error("stream destroyed"));return new Promise((f,u)=>{o=u,n=f,this.once(T,c),this.once("error",h),this.once("end",l),this.once("data",a)})},throw:e,return:e,[Symbol.asyncIterator](){return this}}}[Symbol.iterator](){this[F]=!1;let t=!1,e=()=>(this.pause(),this.off(ve,e),this.off(T,e),this.off("end",e),t=!0,{done:!0,value:void 0}),s=()=>{if(t)return e();let i=this.read();return i===null?e():{done:!1,value:i}};return this.once("end",e),this.once(ve,e),this.once(T,e),{next:s,throw:e,return:e,[Symbol.iterator](){return this}}}destroy(t){if(this[T])return t?this.emit("error",t):this.emit(T),this;this[T]=!0,this[F]=!0,this[O].length=0,this[R]=0;let e=this;return typeof e.close=="function"&&!this[zt]&&e.close(),t?this.emit("error",t):this.emit(T),this}static get isStream(){return gr}};var Ir=Br.native,kt={lstatSync:kr,readdir:Or,readdirSync:Rr,readlinkSync:Nr,realpathSync:Ir,promises:{lstat:Mr,readdir:_r,readlink:Fr,realpath:Dr}},Bs=r=>!r||r===kt||r===Pr?kt:{...kt,...r,promises:{...kt.promises,...r.promises||{}}},Ps=/^\\\\\?\\([a-z]:)\\?$/i,Lr=r=>r.replace(/\//g,"\\").replace(Ps,"$1\\"),jr=/[\\\/]/,U=0,Is=1,Ms=2,Z=4,_s=6,Fs=8,nt=10,Ds=12,j=15,At=~j,Oe=16,ks=32,Ot=64,H=128,Kt=256,Vt=512,Os=Ot|H|Vt,Ur=1023,Re=r=>r.isFile()?Fs:r.isDirectory()?Z:r.isSymbolicLink()?nt:r.isCharacterDevice()?Ms:r.isBlockDevice()?_s:r.isSocket()?Ds:r.isFIFO()?Is:U,Rs=new Map,Rt=r=>{let t=Rs.get(r);if(t)return t;let e=r.normalize("NFKD");return Rs.set(r,e),e},Ns=new Map,Yt=r=>{let t=Ns.get(r);if(t)return t;let e=Rt(r.toLowerCase());return Ns.set(r,e),e},Zt=class extends Et{constructor(){super({max:256})}},Be=class extends Et{constructor(t=16*1024){super({maxSize:t,sizeCalculation:e=>e.length+1})}},Ls=Symbol("PathScurry setAsCwd"),P=class{name;root;roots;parent;nocase;isCWD=!1;#t;#e;get dev(){return this.#e}#n;get mode(){return this.#n}#i;get nlink(){return this.#i}#o;get uid(){return this.#o}#S;get gid(){return this.#S}#l;get rdev(){return this.#l}#f;get blksize(){return this.#f}#h;get ino(){return this.#h}#a;get size(){return this.#a}#r;get blocks(){return this.#r}#g;get atimeMs(){return this.#g}#w;get mtimeMs(){return this.#w}#d;get ctimeMs(){return this.#d}#u;get birthtimeMs(){return this.#u}#x;get atime(){return this.#x}#m;get mtime(){return this.#m}#C;get ctime(){return this.#C}#T;get birthtime(){return this.#T}#y;#E;#v;#p;#R;#A;#s;#P;#b;#N;get parentPath(){return(this.parent||this).fullpath()}get path(){return this.parentPath}constructor(t,e=U,s,i,n,o,h){this.name=t,this.#y=n?Yt(t):Rt(t),this.#s=e&Ur,this.nocase=n,this.roots=i,this.root=s||this,this.#P=o,this.#v=h.fullpath,this.#R=h.relative,this.#A=h.relativePosix,this.parent=h.parent,this.parent?this.#t=this.parent.#t:this.#t=Bs(h.fs)}depth(){return this.#E!==void 0?this.#E:this.parent?this.#E=this.parent.depth()+1:this.#E=0}childrenCache(){return this.#P}resolve(t){if(!t)return this;let e=this.getRootString(t),i=t.substring(e.length).split(this.splitSep);return e?this.getRoot(e).#I(i):this.#I(i)}#I(t){let e=this;for(let s of t)e=e.child(s);return e}children(){let t=this.#P.get(this);if(t)return t;let e=Object.assign([],{provisional:0});return this.#P.set(this,e),this.#s&=~Oe,e}child(t,e){if(t===""||t===".")return this;if(t==="..")return this.parent||this;let s=this.children(),i=this.nocase?Yt(t):Rt(t);for(let a of s)if(a.#y===i)return a;let n=this.parent?this.sep:"",o=this.#v?this.#v+n+t:void 0,h=this.newChild(t,U,{...e,parent:this,fullpath:o});return this.canReaddir()||(h.#s|=H),s.push(h),h}relative(){if(this.isCWD)return"";if(this.#R!==void 0)return this.#R;let t=this.name,e=this.parent;if(!e)return this.#R=this.name;let s=e.relative();return s+(!s||!e.parent?"":this.sep)+t}relativePosix(){if(this.sep==="/")return this.relative();if(this.isCWD)return"";if(this.#A!==void 0)return this.#A;let t=this.name,e=this.parent;if(!e)return this.#A=this.fullpathPosix();let s=e.relativePosix();return s+(!s||!e.parent?"":"/")+t}fullpath(){if(this.#v!==void 0)return this.#v;let t=this.name,e=this.parent;if(!e)return this.#v=this.name;let i=e.fullpath()+(e.parent?this.sep:"")+t;return this.#v=i}fullpathPosix(){if(this.#p!==void 0)return this.#p;if(this.sep==="/")return this.#p=this.fullpath();if(!this.parent){let i=this.fullpath().replace(/\\/g,"/");return/^[a-z]:\//i.test(i)?this.#p=`//?/${i}`:this.#p=i}let t=this.parent,e=t.fullpathPosix(),s=e+(!e||!t.parent?"":"/")+this.name;return this.#p=s}isUnknown(){return(this.#s&j)===U}isType(t){return this[`is${t}`]()}getType(){return this.isUnknown()?"Unknown":this.isDirectory()?"Directory":this.isFile()?"File":this.isSymbolicLink()?"SymbolicLink":this.isFIFO()?"FIFO":this.isCharacterDevice()?"CharacterDevice":this.isBlockDevice()?"BlockDevice":this.isSocket()?"Socket":"Unknown"}isFile(){return(this.#s&j)===Fs}isDirectory(){return(this.#s&j)===Z}isCharacterDevice(){return(this.#s&j)===Ms}isBlockDevice(){return(this.#s&j)===_s}isFIFO(){return(this.#s&j)===Is}isSocket(){return(this.#s&j)===Ds}isSymbolicLink(){return(this.#s&nt)===nt}lstatCached(){return this.#s&ks?this:void 0}readlinkCached(){return this.#b}realpathCached(){return this.#N}readdirCached(){let t=this.children();return t.slice(0,t.provisional)}canReadlink(){if(this.#b)return!0;if(!this.parent)return!1;let t=this.#s&j;return!(t!==U&&t!==nt||this.#s&Kt||this.#s&H)}calledReaddir(){return!!(this.#s&Oe)}isENOENT(){return!!(this.#s&H)}isNamed(t){return this.nocase?this.#y===Yt(t):this.#y===Rt(t)}async readlink(){let t=this.#b;if(t)return t;if(this.canReadlink()&&this.parent)try{let e=await this.#t.promises.readlink(this.fullpath()),s=(await this.parent.realpath())?.resolve(e);if(s)return this.#b=s}catch(e){this.#c(e.code);return}}readlinkSync(){let t=this.#b;if(t)return t;if(this.canReadlink()&&this.parent)try{let e=this.#t.readlinkSync(this.fullpath()),s=this.parent.realpathSync()?.resolve(e);if(s)return this.#b=s}catch(e){this.#c(e.code);return}}#M(t){this.#s|=Oe;for(let e=t.provisional;e<t.length;e++){let s=t[e];s&&s.#_()}}#_(){this.#s&H||(this.#s=(this.#s|H)&At,this.#k())}#k(){let t=this.children();t.provisional=0;for(let e of t)e.#_()}#O(){this.#s|=Vt,this.#F()}#F(){if(this.#s&Ot)return;let t=this.#s;(t&j)===Z&&(t&=At),this.#s=t|Ot,this.#k()}#D(t=""){t==="ENOTDIR"||t==="EPERM"?this.#F():t==="ENOENT"?this.#_():this.children().provisional=0}#L(t=""){t==="ENOTDIR"?this.parent.#F():t==="ENOENT"&&this.#_()}#c(t=""){let e=this.#s;e|=Kt,t==="ENOENT"&&(e|=H),(t==="EINVAL"||t==="UNKNOWN")&&(e&=At),this.#s=e,t==="ENOTDIR"&&this.parent&&this.parent.#F()}#j(t,e){return this.#B(t,e)||this.#U(t,e)}#U(t,e){let s=Re(t),i=this.newChild(t.name,s,{parent:this}),n=i.#s&j;return n!==Z&&n!==nt&&n!==U&&(i.#s|=Ot),e.unshift(i),e.provisional++,i}#B(t,e){for(let s=e.provisional;s<e.length;s++){let i=e[s];if((this.nocase?Yt(t.name):Rt(t.name))===i.#y)return this.#W(t,i,s,e)}}#W(t,e,s,i){let n=e.name;return e.#s=e.#s&At|Re(t),n!==t.name&&(e.name=t.name),s!==i.provisional&&(s===i.length-1?i.pop():i.splice(s,1),i.unshift(e)),i.provisional++,e}async lstat(){if(!(this.#s&H))try{return this.#q(await this.#t.promises.lstat(this.fullpath())),this}catch(t){this.#L(t.code)}}lstatSync(){if(!(this.#s&H))try{return this.#q(this.#t.lstatSync(this.fullpath())),this}catch(t){this.#L(t.code)}}#q(t){let{atime:e,atimeMs:s,birthtime:i,birthtimeMs:n,blksize:o,blocks:h,ctime:a,ctimeMs:l,dev:c,gid:f,ino:u,mode:d,mtime:m,mtimeMs:p,nlink:b,rdev:g,size:S,uid:E}=t;this.#x=e,this.#g=s,this.#T=i,this.#u=n,this.#f=o,this.#r=h,this.#C=a,this.#d=l,this.#e=c,this.#S=f,this.#h=u,this.#n=d,this.#m=m,this.#w=p,this.#i=b,this.#l=g,this.#a=S,this.#o=E;let y=Re(t);this.#s=this.#s&At|y|ks,y!==U&&y!==Z&&y!==nt&&(this.#s|=Ot)}#$=[];#G=!1;#H(t){this.#G=!1;let e=this.#$.slice();this.#$.length=0,e.forEach(s=>s(null,t))}readdirCB(t,e=!1){if(!this.canReaddir()){e?t(null,[]):queueMicrotask(()=>t(null,[]));return}let s=this.children();if(this.calledReaddir()){let n=s.slice(0,s.provisional);e?t(null,n):queueMicrotask(()=>t(null,n));return}if(this.#$.push(t),this.#G)return;this.#G=!0;let i=this.fullpath();this.#t.readdir(i,{withFileTypes:!0},(n,o)=>{if(n)this.#D(n.code),s.provisional=0;else{for(let h of o)this.#j(h,s);this.#M(s)}this.#H(s.slice(0,s.provisional))})}#z;async readdir(){if(!this.canReaddir())return[];let t=this.children();if(this.calledReaddir())return t.slice(0,t.provisional);let e=this.fullpath();if(this.#z)await this.#z;else{let s=()=>{};this.#z=new Promise(i=>s=i);try{for(let i of await this.#t.promises.readdir(e,{withFileTypes:!0}))this.#j(i,t);this.#M(t)}catch(i){this.#D(i.code),t.provisional=0}this.#z=void 0,s()}return t.slice(0,t.provisional)}readdirSync(){if(!this.canReaddir())return[];let t=this.children();if(this.calledReaddir())return t.slice(0,t.provisional);let e=this.fullpath();try{for(let s of this.#t.readdirSync(e,{withFileTypes:!0}))this.#j(s,t);this.#M(t)}catch(s){this.#D(s.code),t.provisional=0}return t.slice(0,t.provisional)}canReaddir(){if(this.#s&Os)return!1;let t=j&this.#s;return t===U||t===Z||t===nt}shouldWalk(t,e){return(this.#s&Z)===Z&&!(this.#s&Os)&&!t.has(this)&&(!e||e(this))}async realpath(){if(this.#N)return this.#N;if(!((Vt|Kt|H)&this.#s))try{let t=await this.#t.promises.realpath(this.fullpath());return this.#N=this.resolve(t)}catch{this.#O()}}realpathSync(){if(this.#N)return this.#N;if(!((Vt|Kt|H)&this.#s))try{let t=this.#t.realpathSync(this.fullpath());return this.#N=this.resolve(t)}catch{this.#O()}}[Ls](t){if(t===this)return;t.isCWD=!1,this.isCWD=!0;let e=new Set([]),s=[],i=this;for(;i&&i.parent;)e.add(i),i.#R=s.join(this.sep),i.#A=s.join("/"),i=i.parent,s.push("..");for(i=t;i&&i.parent&&!e.has(i);)i.#R=void 0,i.#A=void 0,i=i.parent}},Qt=class r extends P{sep="\\";splitSep=jr;constructor(t,e=U,s,i,n,o,h){super(t,e,s,i,n,o,h)}newChild(t,e=U,s={}){return new r(t,e,this.root,this.roots,this.nocase,this.childrenCache(),s)}getRootString(t){return Ne.parse(t).root}getRoot(t){if(t=Lr(t.toUpperCase()),t===this.root.name)return this.root;for(let[e,s]of Object.entries(this.roots))if(this.sameRoot(t,e))return this.roots[t]=s;return this.roots[t]=new ut(t,this).root}sameRoot(t,e=this.root.name){return t=t.toUpperCase().replace(/\//g,"\\").replace(Ps,"$1\\"),t===e}},Jt=class r extends P{splitSep="/";sep="/";constructor(t,e=U,s,i,n,o,h){super(t,e,s,i,n,o,h)}getRootString(t){return t.startsWith("/")?"/":""}getRoot(t){return this.root}newChild(t,e=U,s={}){return new r(t,e,this.root,this.roots,this.nocase,this.childrenCache(),s)}},Xt=class{root;rootPath;roots;cwd;#t;#e;#n;nocase;#i;constructor(t=process.cwd(),e,s,{nocase:i,childrenCacheSize:n=16*1024,fs:o=kt}={}){this.#i=Bs(o),(t instanceof URL||t.startsWith("file://"))&&(t=Ar(t));let h=e.resolve(t);this.roots=Object.create(null),this.rootPath=this.parseRootPath(h),this.#t=new Zt,this.#e=new Zt,this.#n=new Be(n);let a=h.substring(this.rootPath.length).split(s);if(a.length===1&&!a[0]&&a.pop(),i===void 0)throw new TypeError("must provide nocase setting to PathScurryBase ctor");this.nocase=i,this.root=this.newRoot(this.#i),this.roots[this.rootPath]=this.root;let l=this.root,c=a.length-1,f=e.sep,u=this.rootPath,d=!1;for(let m of a){let p=c--;l=l.child(m,{relative:new Array(p).fill("..").join(f),relativePosix:new Array(p).fill("..").join("/"),fullpath:u+=(d?"":f)+m}),d=!0}this.cwd=l}depth(t=this.cwd){return typeof t=="string"&&(t=this.cwd.resolve(t)),t.depth()}childrenCache(){return this.#n}resolve(...t){let e="";for(let n=t.length-1;n>=0;n--){let o=t[n];if(!(!o||o===".")&&(e=e?`${o}/${e}`:o,this.isAbsolute(o)))break}let s=this.#t.get(e);if(s!==void 0)return s;let i=this.cwd.resolve(e).fullpath();return this.#t.set(e,i),i}resolvePosix(...t){let e="";for(let n=t.length-1;n>=0;n--){let o=t[n];if(!(!o||o===".")&&(e=e?`${o}/${e}`:o,this.isAbsolute(o)))break}let s=this.#e.get(e);if(s!==void 0)return s;let i=this.cwd.resolve(e).fullpathPosix();return this.#e.set(e,i),i}relative(t=this.cwd){return typeof t=="string"&&(t=this.cwd.resolve(t)),t.relative()}relativePosix(t=this.cwd){return typeof t=="string"&&(t=this.cwd.resolve(t)),t.relativePosix()}basename(t=this.cwd){return typeof t=="string"&&(t=this.cwd.resolve(t)),t.name}dirname(t=this.cwd){return typeof t=="string"&&(t=this.cwd.resolve(t)),(t.parent||t).fullpath()}async readdir(t=this.cwd,e={withFileTypes:!0}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof P||(e=t,t=this.cwd);let{withFileTypes:s}=e;if(t.canReaddir()){let i=await t.readdir();return s?i:i.map(n=>n.name)}else return[]}readdirSync(t=this.cwd,e={withFileTypes:!0}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof P||(e=t,t=this.cwd);let{withFileTypes:s=!0}=e;return t.canReaddir()?s?t.readdirSync():t.readdirSync().map(i=>i.name):[]}async lstat(t=this.cwd){return typeof t=="string"&&(t=this.cwd.resolve(t)),t.lstat()}lstatSync(t=this.cwd){return typeof t=="string"&&(t=this.cwd.resolve(t)),t.lstatSync()}async readlink(t=this.cwd,{withFileTypes:e}={withFileTypes:!1}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof P||(e=t.withFileTypes,t=this.cwd);let s=await t.readlink();return e?s:s?.fullpath()}readlinkSync(t=this.cwd,{withFileTypes:e}={withFileTypes:!1}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof P||(e=t.withFileTypes,t=this.cwd);let s=t.readlinkSync();return e?s:s?.fullpath()}async realpath(t=this.cwd,{withFileTypes:e}={withFileTypes:!1}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof P||(e=t.withFileTypes,t=this.cwd);let s=await t.realpath();return e?s:s?.fullpath()}realpathSync(t=this.cwd,{withFileTypes:e}={withFileTypes:!1}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof P||(e=t.withFileTypes,t=this.cwd);let s=t.realpathSync();return e?s:s?.fullpath()}async walk(t=this.cwd,e={}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof P||(e=t,t=this.cwd);let{withFileTypes:s=!0,follow:i=!1,filter:n,walkFilter:o}=e,h=[];(!n||n(t))&&h.push(s?t:t.fullpath());let a=new Set,l=(f,u)=>{a.add(f),f.readdirCB((d,m)=>{if(d)return u(d);let p=m.length;if(!p)return u();let b=()=>{--p===0&&u()};for(let g of m)(!n||n(g))&&h.push(s?g:g.fullpath()),i&&g.isSymbolicLink()?g.realpath().then(S=>S?.isUnknown()?S.lstat():S).then(S=>S?.shouldWalk(a,o)?l(S,b):b()):g.shouldWalk(a,o)?l(g,b):b()},!0)},c=t;return new Promise((f,u)=>{l(c,d=>{if(d)return u(d);f(h)})})}walkSync(t=this.cwd,e={}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof P||(e=t,t=this.cwd);let{withFileTypes:s=!0,follow:i=!1,filter:n,walkFilter:o}=e,h=[];(!n||n(t))&&h.push(s?t:t.fullpath());let a=new Set([t]);for(let l of a){let c=l.readdirSync();for(let f of c){(!n||n(f))&&h.push(s?f:f.fullpath());let u=f;if(f.isSymbolicLink()){if(!(i&&(u=f.realpathSync())))continue;u.isUnknown()&&u.lstatSync()}u.shouldWalk(a,o)&&a.add(u)}}return h}[Symbol.asyncIterator](){return this.iterate()}iterate(t=this.cwd,e={}){return typeof t=="string"?t=this.cwd.resolve(t):t instanceof P||(e=t,t=this.cwd),this.stream(t,e)[Symbol.asyncIterator]()}[Symbol.iterator](){return this.iterateSync()}*iterateSync(t=this.cwd,e={}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof P||(e=t,t=this.cwd);let{withFileTypes:s=!0,follow:i=!1,filter:n,walkFilter:o}=e;(!n||n(t))&&(yield s?t:t.fullpath());let h=new Set([t]);for(let a of h){let l=a.readdirSync();for(let c of l){(!n||n(c))&&(yield s?c:c.fullpath());let f=c;if(c.isSymbolicLink()){if(!(i&&(f=c.realpathSync())))continue;f.isUnknown()&&f.lstatSync()}f.shouldWalk(h,o)&&h.add(f)}}}stream(t=this.cwd,e={}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof P||(e=t,t=this.cwd);let{withFileTypes:s=!0,follow:i=!1,filter:n,walkFilter:o}=e,h=new et({objectMode:!0});(!n||n(t))&&h.write(s?t:t.fullpath());let a=new Set,l=[t],c=0,f=()=>{let u=!1;for(;!u;){let d=l.shift();if(!d){c===0&&h.end();return}c++,a.add(d);let m=(b,g,S=!1)=>{if(b)return h.emit("error",b);if(i&&!S){let E=[];for(let y of g)y.isSymbolicLink()&&E.push(y.realpath().then(v=>v?.isUnknown()?v.lstat():v));if(E.length){Promise.all(E).then(()=>m(null,g,!0));return}}for(let E of g)E&&(!n||n(E))&&(h.write(s?E:E.fullpath())||(u=!0));c--;for(let E of g){let y=E.realpathCached()||E;y.shouldWalk(a,o)&&l.push(y)}u&&!h.flowing?h.once("drain",f):p||f()},p=!0;d.readdirCB(m,!0),p=!1}};return f(),h}streamSync(t=this.cwd,e={}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof P||(e=t,t=this.cwd);let{withFileTypes:s=!0,follow:i=!1,filter:n,walkFilter:o}=e,h=new et({objectMode:!0}),a=new Set;(!n||n(t))&&h.write(s?t:t.fullpath());let l=[t],c=0,f=()=>{let u=!1;for(;!u;){let d=l.shift();if(!d){c===0&&h.end();return}c++,a.add(d);let m=d.readdirSync();for(let p of m)(!n||n(p))&&(h.write(s?p:p.fullpath())||(u=!0));c--;for(let p of m){let b=p;if(p.isSymbolicLink()){if(!(i&&(b=p.realpathSync())))continue;b.isUnknown()&&b.lstatSync()}b.shouldWalk(a,o)&&l.push(b)}}u&&!h.flowing&&h.once("drain",f)};return f(),h}chdir(t=this.cwd){let e=this.cwd;this.cwd=typeof t=="string"?this.cwd.resolve(t):t,this.cwd[Ls](e)}},ut=class extends Xt{sep="\\";constructor(t=process.cwd(),e={}){let{nocase:s=!0}=e;super(t,Ne,"\\",{...e,nocase:s}),this.nocase=s;for(let i=this.cwd;i;i=i.parent)i.nocase=this.nocase}parseRootPath(t){return Ne.parse(t).root.toUpperCase()}newRoot(t){return new Qt(this.rootPath,Z,void 0,this.roots,this.nocase,this.childrenCache(),{fs:t})}isAbsolute(t){return t.startsWith("/")||t.startsWith("\\")||/^[a-z]:(\/|\\)/i.test(t)}},dt=class extends Xt{sep="/";constructor(t=process.cwd(),e={}){let{nocase:s=!1}=e;super(t,Tr,"/",{...e,nocase:s}),this.nocase=s}parseRootPath(t){return"/"}newRoot(t){return new Jt(this.rootPath,Z,void 0,this.roots,this.nocase,this.childrenCache(),{fs:t})}isAbsolute(t){return t.startsWith("/")}},Nt=class extends dt{constructor(t=process.cwd(),e={}){let{nocase:s=!0}=e;super(t,{...e,nocase:s})}},To=process.platform==="win32"?Qt:Jt,js=process.platform==="win32"?ut:process.platform==="darwin"?Nt:dt;w();var Wr=r=>r.length>=1,zr=r=>r.length>=1,pt=class r{#t;#e;#n;length;#i;#o;#S;#l;#f;#h;#a=!0;constructor(t,e,s,i){if(!Wr(t))throw new TypeError("empty pattern list");if(!zr(e))throw new TypeError("empty glob list");if(e.length!==t.length)throw new TypeError("mismatched pattern list and glob list lengths");if(this.length=t.length,s<0||s>=this.length)throw new TypeError("index out of range");if(this.#t=t,this.#e=e,this.#n=s,this.#i=i,this.#n===0){if(this.isUNC()){let[n,o,h,a,...l]=this.#t,[c,f,u,d,...m]=this.#e;l[0]===""&&(l.shift(),m.shift());let p=[n,o,h,a,""].join("/"),b=[c,f,u,d,""].join("/");this.#t=[p,...l],this.#e=[b,...m],this.length=this.#t.length}else if(this.isDrive()||this.isAbsolute()){let[n,...o]=this.#t,[h,...a]=this.#e;o[0]===""&&(o.shift(),a.shift());let l=n+"/",c=h+"/";this.#t=[l,...o],this.#e=[c,...a],this.length=this.#t.length}}}pattern(){return this.#t[this.#n]}isString(){return typeof this.#t[this.#n]=="string"}isGlobstar(){return this.#t[this.#n]===N}isRegExp(){return this.#t[this.#n]instanceof RegExp}globString(){return this.#S=this.#S||(this.#n===0?this.isAbsolute()?this.#e[0]+this.#e.slice(1).join("/"):this.#e.join("/"):this.#e.slice(this.#n).join("/"))}hasMore(){return this.length>this.#n+1}rest(){return this.#o!==void 0?this.#o:this.hasMore()?(this.#o=new r(this.#t,this.#e,this.#n+1,this.#i),this.#o.#h=this.#h,this.#o.#f=this.#f,this.#o.#l=this.#l,this.#o):this.#o=null}isUNC(){let t=this.#t;return this.#f!==void 0?this.#f:this.#f=this.#i==="win32"&&this.#n===0&&t[0]===""&&t[1]===""&&typeof t[2]=="string"&&!!t[2]&&typeof t[3]=="string"&&!!t[3]}isDrive(){let t=this.#t;return this.#l!==void 0?this.#l:this.#l=this.#i==="win32"&&this.#n===0&&this.length>1&&typeof t[0]=="string"&&/^[a-z]:$/i.test(t[0])}isAbsolute(){let t=this.#t;return this.#h!==void 0?this.#h:this.#h=t[0]===""&&t.length>1||this.isDrive()||this.isUNC()}root(){let t=this.#t[0];return typeof t=="string"&&this.isAbsolute()&&this.#n===0?t:""}checkFollowGlobstar(){return!(this.#n===0||!this.isGlobstar()||!this.#a)}markFollowGlobstar(){return this.#n===0||!this.isGlobstar()||!this.#a?!1:(this.#a=!1,!0)}};w();w();var $r=typeof process=="object"&&process&&typeof process.platform=="string"?process.platform:"linux",mt=class{relative;relativeChildren;absolute;absoluteChildren;platform;mmopts;constructor(t,{nobrace:e,nocase:s,noext:i,noglobstar:n,platform:o=$r}){this.relative=[],this.absolute=[],this.relativeChildren=[],this.absoluteChildren=[],this.platform=o,this.mmopts={dot:!0,nobrace:e,nocase:s,noext:i,noglobstar:n,optimizationLevel:2,platform:o,nocomment:!0,nonegate:!0};for(let h of t)this.add(h)}add(t){let e=new _(t,this.mmopts);for(let s=0;s<e.set.length;s++){let i=e.set[s],n=e.globParts[s];if(!i||!n)throw new Error("invalid pattern object");for(;i[0]==="."&&n[0]===".";)i.shift(),n.shift();let o=new pt(i,n,0,this.platform),h=new _(o.globString(),this.mmopts),a=n[n.length-1]==="**",l=o.isAbsolute();l?this.absolute.push(h):this.relative.push(h),a&&(l?this.absoluteChildren.push(h):this.relativeChildren.push(h))}}ignored(t){let e=t.fullpath(),s=`${e}/`,i=t.relative()||".",n=`${i}/`;for(let o of this.relative)if(o.match(i)||o.match(n))return!0;for(let o of this.absolute)if(o.match(e)||o.match(s))return!0;return!1}childrenIgnored(t){let e=t.fullpath()+"/",s=(t.relative()||".")+"/";for(let i of this.relativeChildren)if(i.match(s))return!0;for(let i of this.absoluteChildren)if(i.match(e))return!0;return!1}};w();var Pe=class r{store;constructor(t=new Map){this.store=t}copy(){return new r(new Map(this.store))}hasWalked(t,e){return this.store.get(t.fullpath())?.has(e.globString())}storeWalked(t,e){let s=t.fullpath(),i=this.store.get(s);i?i.add(e.globString()):this.store.set(s,new Set([e.globString()]))}},Ie=class{store=new Map;add(t,e,s){let i=(e?2:0)|(s?1:0),n=this.store.get(t);this.store.set(t,n===void 0?i:i&n)}entries(){return[...this.store.entries()].map(([t,e])=>[t,!!(e&2),!!(e&1)])}},Me=class{store=new Map;add(t,e){if(!t.canReaddir())return;let s=this.store.get(t);s?s.find(i=>i.globString()===e.globString())||s.push(e):this.store.set(t,[e])}get(t){let e=this.store.get(t);if(!e)throw new Error("attempting to walk unknown path");return e}entries(){return this.keys().map(t=>[t,this.store.get(t)])}keys(){return[...this.store.keys()].filter(t=>t.canReaddir())}},Bt=class r{hasWalkedCache;matches=new Ie;subwalks=new Me;patterns;follow;dot;opts;constructor(t,e){this.opts=t,this.follow=!!t.follow,this.dot=!!t.dot,this.hasWalkedCache=e?e.copy():new Pe}processPatterns(t,e){this.patterns=e;let s=e.map(i=>[t,i]);for(let[i,n]of s){this.hasWalkedCache.storeWalked(i,n);let o=n.root(),h=n.isAbsolute()&&this.opts.absolute!==!1;if(o){i=i.resolve(o==="/"&&this.opts.root!==void 0?this.opts.root:o);let f=n.rest();if(f)n=f;else{this.matches.add(i,!0,!1);continue}}if(i.isENOENT())continue;let a,l,c=!1;for(;typeof(a=n.pattern())=="string"&&(l=n.rest());)i=i.resolve(a),n=l,c=!0;if(a=n.pattern(),l=n.rest(),c){if(this.hasWalkedCache.hasWalked(i,n))continue;this.hasWalkedCache.storeWalked(i,n)}if(typeof a=="string"){let f=a===".."||a===""||a===".";this.matches.add(i.resolve(a),h,f);continue}else if(a===N){(!i.isSymbolicLink()||this.follow||n.checkFollowGlobstar())&&this.subwalks.add(i,n);let f=l?.pattern(),u=l?.rest();if(!l||(f===""||f===".")&&!u)this.matches.add(i,h,f===""||f===".");else if(f===".."){let d=i.parent||i;u?this.hasWalkedCache.hasWalked(d,u)||this.subwalks.add(d,u):this.matches.add(d,h,!0)}}else a instanceof RegExp&&this.subwalks.add(i,n)}return this}subwalkTargets(){return this.subwalks.keys()}child(){return new r(this.opts,this.hasWalkedCache)}filterEntries(t,e){let s=this.subwalks.get(t),i=this.child();for(let n of e)for(let o of s){let h=o.isAbsolute(),a=o.pattern(),l=o.rest();a===N?i.testGlobstar(n,o,l,h):a instanceof RegExp?i.testRegExp(n,a,l,h):i.testString(n,a,l,h)}return i}testGlobstar(t,e,s,i){if((this.dot||!t.name.startsWith("."))&&(e.hasMore()||this.matches.add(t,i,!1),t.canReaddir()&&(this.follow||!t.isSymbolicLink()?this.subwalks.add(t,e):t.isSymbolicLink()&&(s&&e.checkFollowGlobstar()?this.subwalks.add(t,s):e.markFollowGlobstar()&&this.subwalks.add(t,e)))),s){let n=s.pattern();if(typeof n=="string"&&n!==".."&&n!==""&&n!==".")this.testString(t,n,s.rest(),i);else if(n===".."){let o=t.parent||t;this.subwalks.add(o,s)}else n instanceof RegExp&&this.testRegExp(t,n,s.rest(),i)}}testRegExp(t,e,s,i){e.test(t.name)&&(s?this.subwalks.add(t,s):this.matches.add(t,i,!1))}testString(t,e,s,i){t.isNamed(e)&&(s?this.subwalks.add(t,s):this.matches.add(t,i,!1))}};var Gr=(r,t)=>typeof r=="string"?new mt([r],t):Array.isArray(r)?new mt(r,t):r,te=class{path;patterns;opts;seen=new Set;paused=!1;aborted=!1;#t=[];#e;#n;signal;maxDepth;includeChildMatches;constructor(t,e,s){if(this.patterns=t,this.path=e,this.opts=s,this.#n=!s.posix&&s.platform==="win32"?"\\":"/",this.includeChildMatches=s.includeChildMatches!==!1,(s.ignore||!this.includeChildMatches)&&(this.#e=Gr(s.ignore??[],s),!this.includeChildMatches&&typeof this.#e.add!="function")){let i="cannot ignore child matches, ignore lacks add() method.";throw new Error(i)}this.maxDepth=s.maxDepth||1/0,s.signal&&(this.signal=s.signal,this.signal.addEventListener("abort",()=>{this.#t.length=0}))}#i(t){return this.seen.has(t)||!!this.#e?.ignored?.(t)}#o(t){return!!this.#e?.childrenIgnored?.(t)}pause(){this.paused=!0}resume(){if(this.signal?.aborted)return;this.paused=!1;let t;for(;!this.paused&&(t=this.#t.shift());)t()}onResume(t){this.signal?.aborted||(this.paused?this.#t.push(t):t())}async matchCheck(t,e){if(e&&this.opts.nodir)return;let s;if(this.opts.realpath){if(s=t.realpathCached()||await t.realpath(),!s)return;t=s}let n=t.isUnknown()||this.opts.stat?await t.lstat():t;if(this.opts.follow&&this.opts.nodir&&n?.isSymbolicLink()){let o=await n.realpath();o&&(o.isUnknown()||this.opts.stat)&&await o.lstat()}return this.matchCheckTest(n,e)}matchCheckTest(t,e){return t&&(this.maxDepth===1/0||t.depth()<=this.maxDepth)&&(!e||t.canReaddir())&&(!this.opts.nodir||!t.isDirectory())&&(!this.opts.nodir||!this.opts.follow||!t.isSymbolicLink()||!t.realpathCached()?.isDirectory())&&!this.#i(t)?t:void 0}matchCheckSync(t,e){if(e&&this.opts.nodir)return;let s;if(this.opts.realpath){if(s=t.realpathCached()||t.realpathSync(),!s)return;t=s}let n=t.isUnknown()||this.opts.stat?t.lstatSync():t;if(this.opts.follow&&this.opts.nodir&&n?.isSymbolicLink()){let o=n.realpathSync();o&&(o?.isUnknown()||this.opts.stat)&&o.lstatSync()}return this.matchCheckTest(n,e)}matchFinish(t,e){if(this.#i(t))return;if(!this.includeChildMatches&&this.#e?.add){let n=`${t.relativePosix()}/**`;this.#e.add(n)}let s=this.opts.absolute===void 0?e:this.opts.absolute;this.seen.add(t);let i=this.opts.mark&&t.isDirectory()?this.#n:"";if(this.opts.withFileTypes)this.matchEmit(t);else if(s){let n=this.opts.posix?t.fullpathPosix():t.fullpath();this.matchEmit(n+i)}else{let n=this.opts.posix?t.relativePosix():t.relative(),o=this.opts.dotRelative&&!n.startsWith(".."+this.#n)?"."+this.#n:"";this.matchEmit(n?o+n+i:"."+i)}}async match(t,e,s){let i=await this.matchCheck(t,s);i&&this.matchFinish(i,e)}matchSync(t,e,s){let i=this.matchCheckSync(t,s);i&&this.matchFinish(i,e)}walkCB(t,e,s){this.signal?.aborted&&s(),this.walkCB2(t,e,new Bt(this.opts),s)}walkCB2(t,e,s,i){if(this.#o(t))return i();if(this.signal?.aborted&&i(),this.paused){this.onResume(()=>this.walkCB2(t,e,s,i));return}s.processPatterns(t,e);let n=1,o=()=>{--n===0&&i()};for(let[h,a,l]of s.matches.entries())this.#i(h)||(n++,this.match(h,a,l).then(()=>o()));for(let h of s.subwalkTargets()){if(this.maxDepth!==1/0&&h.depth()>=this.maxDepth)continue;n++;let a=h.readdirCached();h.calledReaddir()?this.walkCB3(h,a,s,o):h.readdirCB((l,c)=>this.walkCB3(h,c,s,o),!0)}o()}walkCB3(t,e,s,i){s=s.filterEntries(t,e);let n=1,o=()=>{--n===0&&i()};for(let[h,a,l]of s.matches.entries())this.#i(h)||(n++,this.match(h,a,l).then(()=>o()));for(let[h,a]of s.subwalks.entries())n++,this.walkCB2(h,a,s.child(),o);o()}walkCBSync(t,e,s){this.signal?.aborted&&s(),this.walkCB2Sync(t,e,new Bt(this.opts),s)}walkCB2Sync(t,e,s,i){if(this.#o(t))return i();if(this.signal?.aborted&&i(),this.paused){this.onResume(()=>this.walkCB2Sync(t,e,s,i));return}s.processPatterns(t,e);let n=1,o=()=>{--n===0&&i()};for(let[h,a,l]of s.matches.entries())this.#i(h)||this.matchSync(h,a,l);for(let h of s.subwalkTargets()){if(this.maxDepth!==1/0&&h.depth()>=this.maxDepth)continue;n++;let a=h.readdirSync();this.walkCB3Sync(h,a,s,o)}o()}walkCB3Sync(t,e,s,i){s=s.filterEntries(t,e);let n=1,o=()=>{--n===0&&i()};for(let[h,a,l]of s.matches.entries())this.#i(h)||this.matchSync(h,a,l);for(let[h,a]of s.subwalks.entries())n++,this.walkCB2Sync(h,a,s.child(),o);o()}},Pt=class extends te{matches=new Set;constructor(t,e,s){super(t,e,s)}matchEmit(t){this.matches.add(t)}async walk(){if(this.signal?.aborted)throw this.signal.reason;return this.path.isUnknown()&&await this.path.lstat(),await new Promise((t,e)=>{this.walkCB(this.path,this.patterns,()=>{this.signal?.aborted?e(this.signal.reason):t(this.matches)})}),this.matches}walkSync(){if(this.signal?.aborted)throw this.signal.reason;return this.path.isUnknown()&&this.path.lstatSync(),this.walkCBSync(this.path,this.patterns,()=>{if(this.signal?.aborted)throw this.signal.reason}),this.matches}},It=class extends te{results;constructor(t,e,s){super(t,e,s),this.results=new et({signal:this.signal,objectMode:!0}),this.results.on("drain",()=>this.resume()),this.results.on("resume",()=>this.resume())}matchEmit(t){this.results.write(t),this.results.flowing||this.pause()}stream(){let t=this.path;return t.isUnknown()?t.lstat().then(()=>{this.walkCB(t,this.patterns,()=>this.results.end())}):this.walkCB(t,this.patterns,()=>this.results.end()),this.results}streamSync(){return this.path.isUnknown()&&this.path.lstatSync(),this.walkCBSync(this.path,this.patterns,()=>this.results.end()),this.results}};var Hr=typeof process=="object"&&process&&typeof process.platform=="string"?process.platform:"linux",K=class{absolute;cwd;root;dot;dotRelative;follow;ignore;magicalBraces;mark;matchBase;maxDepth;nobrace;nocase;nodir;noext;noglobstar;pattern;platform;realpath;scurry;stat;signal;windowsPathsNoEscape;withFileTypes;includeChildMatches;opts;patterns;constructor(t,e){if(!e)throw new TypeError("glob options required");if(this.withFileTypes=!!e.withFileTypes,this.signal=e.signal,this.follow=!!e.follow,this.dot=!!e.dot,this.dotRelative=!!e.dotRelative,this.nodir=!!e.nodir,this.mark=!!e.mark,e.cwd?(e.cwd instanceof URL||e.cwd.startsWith("file://"))&&(e.cwd=qr(e.cwd)):this.cwd="",this.cwd=e.cwd||"",this.root=e.root,this.magicalBraces=!!e.magicalBraces,this.nobrace=!!e.nobrace,this.noext=!!e.noext,this.realpath=!!e.realpath,this.absolute=e.absolute,this.includeChildMatches=e.includeChildMatches!==!1,this.noglobstar=!!e.noglobstar,this.matchBase=!!e.matchBase,this.maxDepth=typeof e.maxDepth=="number"?e.maxDepth:1/0,this.stat=!!e.stat,this.ignore=e.ignore,this.withFileTypes&&this.absolute!==void 0)throw new Error("cannot set absolute and withFileTypes:true");if(typeof t=="string"&&(t=[t]),this.windowsPathsNoEscape=!!e.windowsPathsNoEscape||e.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(t=t.map(a=>a.replace(/\\/g,"/"))),this.matchBase){if(e.noglobstar)throw new TypeError("base matching requires globstar");t=t.map(a=>a.includes("/")?a:`./**/${a}`)}if(this.pattern=t,this.platform=e.platform||Hr,this.opts={...e,platform:this.platform},e.scurry){if(this.scurry=e.scurry,e.nocase!==void 0&&e.nocase!==e.scurry.nocase)throw new Error("nocase option contradicts provided scurry option")}else{let a=e.platform==="win32"?ut:e.platform==="darwin"?Nt:e.platform?dt:js;this.scurry=new a(this.cwd,{nocase:e.nocase,fs:e.fs})}this.nocase=this.scurry.nocase;let s=this.platform==="darwin"||this.platform==="win32",i={...e,dot:this.dot,matchBase:this.matchBase,nobrace:this.nobrace,nocase:this.nocase,nocaseMagicOnly:s,nocomment:!0,noext:this.noext,nonegate:!0,optimizationLevel:2,platform:this.platform,windowsPathsNoEscape:this.windowsPathsNoEscape,debug:!!this.opts.debug},n=this.pattern.map(a=>new _(a,i)),[o,h]=n.reduce((a,l)=>(a[0].push(...l.set),a[1].push(...l.globParts),a),[[],[]]);this.patterns=o.map((a,l)=>{let c=h[l];if(!c)throw new Error("invalid pattern object");return new pt(a,c,0,this.platform)})}async walk(){return[...await new Pt(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).walk()]}walkSync(){return[...new Pt(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).walkSync()]}stream(){return new It(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).stream()}streamSync(){return new It(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).streamSync()}iterateSync(){return this.streamSync()[Symbol.iterator]()}[Symbol.iterator](){return this.iterateSync()}iterate(){return this.stream()[Symbol.asyncIterator]()}[Symbol.asyncIterator](){return this.iterate()}};w();var _e=(r,t={})=>{Array.isArray(r)||(r=[r]);for(let e of r)if(new _(e,t).hasMagic())return!0;return!1};function se(r,t={}){return new K(r,t).streamSync()}function Ws(r,t={}){return new K(r,t).stream()}function zs(r,t={}){return new K(r,t).walkSync()}async function Us(r,t={}){return new K(r,t).walk()}function ie(r,t={}){return new K(r,t).iterateSync()}function $s(r,t={}){return new K(r,t).iterate()}var Kr=se,Yr=Object.assign(Ws,{sync:se}),Vr=ie,Zr=Object.assign($s,{sync:ie}),Qr=Object.assign(zs,{stream:se,iterate:ie}),ee=Object.assign(Us,{glob:Us,globSync:zs,sync:Qr,globStream:Ws,stream:Yr,globStreamSync:se,streamSync:Kr,globIterate:$s,iterate:Zr,globIterateSync:ie,iterateSync:Vr,Glob:K,hasMagic:_e,escape:ht,unescape:G});ee.glob=ee;import Gs from"path";import{fileURLToPath as Jr}from"url";function qs(r){return Gs.dirname(Jr(r))}async function Hs(...r){let t=[];return await Promise.all(r.map(async e=>{(await ee(e.split(Gs.sep).join("/"))).forEach(i=>{t.includes(i)||t.push(`file://${i}`)})})),t}import{homedir as Xr}from"os";import Ks from"path";var tn=await Hs(`${qs(import.meta.url)}/commands/*.{ts,js}`),en=Ks.join(Xr(),".tdb"),Ys=Ks.join(en,"data"),gh=await Promise.all(tn.map(async r=>{let{command:t}=await import(r);return t}));w();w();w();var Vs=(r=0)=>t=>`\x1B[${t+r}m`,Zs=(r=0)=>t=>`\x1B[${38+r};5;${t}m`,Qs=(r=0)=>(t,e,s)=>`\x1B[${38+r};2;${t};${e};${s}m`,x={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],gray:[90,39],grey:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgGray:[100,49],bgGrey:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}},yh=Object.keys(x.modifier),sn=Object.keys(x.color),rn=Object.keys(x.bgColor),Sh=[...sn,...rn];function nn(){let r=new Map;for(let[t,e]of Object.entries(x)){for(let[s,i]of Object.entries(e))x[s]={open:`\x1B[${i[0]}m`,close:`\x1B[${i[1]}m`},e[s]=x[s],r.set(i[0],i[1]);Object.defineProperty(x,t,{value:e,enumerable:!1})}return Object.defineProperty(x,"codes",{value:r,enumerable:!1}),x.color.close="\x1B[39m",x.bgColor.close="\x1B[49m",x.color.ansi=Vs(),x.color.ansi256=Zs(),x.color.ansi16m=Qs(),x.bgColor.ansi=Vs(10),x.bgColor.ansi256=Zs(10),x.bgColor.ansi16m=Qs(10),Object.defineProperties(x,{rgbToAnsi256:{value(t,e,s){return t===e&&e===s?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(e/255*5)+Math.round(s/255*5)},enumerable:!1},hexToRgb:{value(t){let e=/[a-f\d]{6}|[a-f\d]{3}/i.exec(t.toString(16));if(!e)return[0,0,0];let[s]=e;s.length===3&&(s=[...s].map(n=>n+n).join(""));let i=Number.parseInt(s,16);return[i>>16&255,i>>8&255,i&255]},enumerable:!1},hexToAnsi256:{value:t=>x.rgbToAnsi256(...x.hexToRgb(t)),enumerable:!1},ansi256ToAnsi:{value(t){if(t<8)return 30+t;if(t<16)return 90+(t-8);let e,s,i;if(t>=232)e=((t-232)*10+8)/255,s=e,i=e;else{t-=16;let h=t%36;e=Math.floor(t/36)/5,s=Math.floor(h/6)/5,i=h%6/5}let n=Math.max(e,s,i)*2;if(n===0)return 30;let o=30+(Math.round(i)<<2|Math.round(s)<<1|Math.round(e));return n===2&&(o+=60),o},enumerable:!1},rgbToAnsi:{value:(t,e,s)=>x.ansi256ToAnsi(x.rgbToAnsi256(t,e,s)),enumerable:!1},hexToAnsi:{value:t=>x.ansi256ToAnsi(x.hexToAnsi256(t)),enumerable:!1}}),x}var on=nn(),Y=on;w();import Fe from"node:process";import hn from"node:os";import Js from"node:tty";function W(r,t=globalThis.Deno?globalThis.Deno.args:Fe.argv){let e=r.startsWith("-")?"":r.length===1?"-":"--",s=t.indexOf(e+r),i=t.indexOf("--");return s!==-1&&(i===-1||s<i)}var{env:C}=Fe,re;W("no-color")||W("no-colors")||W("color=false")||W("color=never")?re=0:(W("color")||W("colors")||W("color=true")||W("color=always"))&&(re=1);function an(){if("FORCE_COLOR"in C)return C.FORCE_COLOR==="true"?1:C.FORCE_COLOR==="false"?0:C.FORCE_COLOR.length===0?1:Math.min(Number.parseInt(C.FORCE_COLOR,10),3)}function ln(r){return r===0?!1:{level:r,hasBasic:!0,has256:r>=2,has16m:r>=3}}function cn(r,{streamIsTTY:t,sniffFlags:e=!0}={}){let s=an();s!==void 0&&(re=s);let i=e?re:s;if(i===0)return 0;if(e){if(W("color=16m")||W("color=full")||W("color=truecolor"))return 3;if(W("color=256"))return 2}if("TF_BUILD"in C&&"AGENT_NAME"in C)return 1;if(r&&!t&&i===void 0)return 0;let n=i||0;if(C.TERM==="dumb")return n;if(Fe.platform==="win32"){let o=hn.release().split(".");return Number(o[0])>=10&&Number(o[2])>=10586?Number(o[2])>=14931?3:2:1}if("CI"in C)return"GITHUB_ACTIONS"in C||"GITEA_ACTIONS"in C?3:["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","BUILDKITE","DRONE"].some(o=>o in C)||C.CI_NAME==="codeship"?1:n;if("TEAMCITY_VERSION"in C)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(C.TEAMCITY_VERSION)?1:0;if(C.COLORTERM==="truecolor"||C.TERM==="xterm-kitty")return 3;if("TERM_PROGRAM"in C){let o=Number.parseInt((C.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(C.TERM_PROGRAM){case"iTerm.app":return o>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(C.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(C.TERM)||"COLORTERM"in C?1:n}function Xs(r,t={}){let e=cn(r,{streamIsTTY:r&&r.isTTY,...t});return ln(e)}var fn={stdout:Xs({isTTY:Js.isatty(1)}),stderr:Xs({isTTY:Js.isatty(2)})},ti=fn;w();function ei(r,t,e){let s=r.indexOf(t);if(s===-1)return r;let i=t.length,n=0,o="";do o+=r.slice(n,s)+t+e,n=s+i,s=r.indexOf(t,n);while(s!==-1);return o+=r.slice(n),o}function si(r,t,e,s){let i=0,n="";do{let o=r[s-1]==="\r";n+=r.slice(i,o?s-1:s)+t+(o?`\r
`:`
`)+e,i=s+1,s=r.indexOf(`
`,i)}while(s!==-1);return n+=r.slice(i),n}var{stdout:ii,stderr:ri}=ti,De=Symbol("GENERATOR"),gt=Symbol("STYLER"),Mt=Symbol("IS_EMPTY"),ni=["ansi","ansi","ansi256","ansi16m"],wt=Object.create(null),un=(r,t={})=>{if(t.level&&!(Number.isInteger(t.level)&&t.level>=0&&t.level<=3))throw new Error("The `level` option should be an integer from 0 to 3");let e=ii?ii.level:0;r.level=t.level===void 0?e:t.level};var dn=r=>{let t=(...e)=>e.join(" ");return un(t,r),Object.setPrototypeOf(t,_t.prototype),t};function _t(r){return dn(r)}Object.setPrototypeOf(_t.prototype,Function.prototype);for(let[r,t]of Object.entries(Y))wt[r]={get(){let e=ne(this,je(t.open,t.close,this[gt]),this[Mt]);return Object.defineProperty(this,r,{value:e}),e}};wt.visible={get(){let r=ne(this,this[gt],!0);return Object.defineProperty(this,"visible",{value:r}),r}};var Le=(r,t,e,...s)=>r==="rgb"?t==="ansi16m"?Y[e].ansi16m(...s):t==="ansi256"?Y[e].ansi256(Y.rgbToAnsi256(...s)):Y[e].ansi(Y.rgbToAnsi(...s)):r==="hex"?Le("rgb",t,e,...Y.hexToRgb(...s)):Y[e][r](...s),pn=["rgb","hex","ansi256"];for(let r of pn){wt[r]={get(){let{level:e}=this;return function(...s){let i=je(Le(r,ni[e],"color",...s),Y.color.close,this[gt]);return ne(this,i,this[Mt])}}};let t="bg"+r[0].toUpperCase()+r.slice(1);wt[t]={get(){let{level:e}=this;return function(...s){let i=je(Le(r,ni[e],"bgColor",...s),Y.bgColor.close,this[gt]);return ne(this,i,this[Mt])}}}}var mn=Object.defineProperties(()=>{},{...wt,level:{enumerable:!0,get(){return this[De].level},set(r){this[De].level=r}}}),je=(r,t,e)=>{let s,i;return e===void 0?(s=r,i=t):(s=e.openAll+r,i=t+e.closeAll),{open:r,close:t,openAll:s,closeAll:i,parent:e}},ne=(r,t,e)=>{let s=(...i)=>gn(s,i.length===1?""+i[0]:i.join(" "));return Object.setPrototypeOf(s,mn),s[De]=r,s[gt]=t,s[Mt]=e,s},gn=(r,t)=>{if(r.level<=0||!t)return r[Mt]?"":t;let e=r[gt];if(e===void 0)return t;let{openAll:s,closeAll:i}=e;if(t.includes("\x1B"))for(;e!==void 0;)t=ei(t,e.close,e.open),e=e.parent;let n=t.indexOf(`
`);return n!==-1&&(t=si(t,i,s,n)),s+t+i};Object.defineProperties(_t.prototype,wt);var wn=_t(),Ih=_t({level:ri?ri.level:0});var st=wn;var ui=me(Ue(),1);import{randomInt as An}from"crypto";import*as fi from"fs";import*as de from"net";import*as di from"tls";import*as pi from"util";w();var hi=me(Ue(),1);import{randomInt as oi}from"crypto";var We=192,ze=219,bn=220,yn=221;function Sn(r){let t=[We];for(let e of r)e===We?t.push(ze,bn):e===ze?t.push(ze,yn):t.push(e);return t.push(We),Buffer.from(t)}function oe(r){let t=r[0]>>4&15,e=(r[0]&15)*4,s=r.readUInt16BE(2),i=r[9],n=r.slice(12,16).join("."),o=r.slice(16,20).join(".");return{version:t,headerLength:e,totalLength:s,protocol:i,srcIP:n,dstIP:o,payload:r.slice(e,s)}}function he(r){let t=r.readUInt16BE(0),e=r.readUInt16BE(2),s=r.readUInt32BE(4),i=r.readUInt32BE(8),n=(r[12]>>4&15)*4,o=r[13],h=r.readUInt16BE(14);return{srcPort:t,dstPort:e,seqNumber:s,ackNumber:i,headerLength:n,flags:o,windowSize:h,payload:r.slice(n)}}function En(r){let t=0;for(let e=0;e<r.length;e+=2)t+=r.readUInt16BE(e);return t=(t>>16)+(t&65535),t+=t>>16,~t&65535}function ae(r,t,e){let s=Buffer.alloc(12);r.split(".").forEach((o,h)=>{s[h]=parseInt(o)}),t.split(".").forEach((o,h)=>{s[4+h]=parseInt(o)}),s[8]=0,s[9]=6,s.writeUInt16BE(e.length,10);let i=Buffer.concat([s,e]),n=0;for(let o=0;o<i.length;o+=2)o===i.length-1?n+=i[o]<<8:n+=i.readUInt16BE(o);return n=(n>>16)+(n&65535),n+=n>>16,~n&65535}function le(r,t,e,s,i,n,o){let a=20+o.length,l=Buffer.alloc(a);return l.writeUInt16BE(t,0),l.writeUInt16BE(r,2),l.writeUInt32BE(e,4),l.writeUInt32BE(s,8),l[12]=20/4<<4,l[13]=i,l.writeUInt16BE(n,14),l.writeUInt16BE(0,16),l.writeUInt16BE(0,18),o.copy(l,20),l}function ce(r,t,e,s){let n=20+s.length,o=Buffer.alloc(n);o[0]=69,o[1]=0,o.writeUInt16BE(n,2),o.writeUInt16BE(oi(65536),4),o.writeUInt16BE(16384,6),o[8]=64,o[9]=e,o.writeUInt16BE(0,10),r.split(".").forEach((a,l)=>{o[12+l]=parseInt(a)}),t.split(".").forEach((a,l)=>{o[16+l]=parseInt(a)});let h=En(o.slice(0,20));return o.writeUInt16BE(h,10),s.copy(o,20),o}function fe(r,t){Ge(r);let e=Sn(r);t.serial_send_bytes(1,e)}async function ai(r,t,e,s,i){let o=oi(4294967295),h=le(e,s,o,0,2,64240,Buffer.alloc(0)),a=ae(r,t,h);h.writeUInt16BE(a,16);let l=ce(r,t,6,h);fe(l,i);let c=await xn(i,r,t,e,s,o);return[o+1,c]}function vn(r){return["FIN","SYN","RST","PSH","ACK","URG","ECE","CWR"].filter((e,s)=>r>>s&1)}function xn(r,t,e,s,i,n){return new Promise((o,h)=>{let a=new hi.default.Decoder({maxMessageSize:209715200,bufferSize:2048,onMessage:c=>{let f=oe(Buffer.from(c));if(f.protocol===6){let u=he(f.payload);if(u.flags===18&&u.ackNumber===n+1){let m=le(s,i,n+1,u.seqNumber+1,16,64240,Buffer.alloc(0)),p=ae(t,e,m);m.writeUInt16BE(p,16);let b=ce(t,e,6,m);fe(b,r),r.remove_listener("serial1-output-byte",l),o(u.seqNumber+1)}}}}),l=c=>{a.decode(Buffer.from([c]))};r.add_listener("serial1-output-byte",l),setTimeout(()=>{r.remove_listener("serial1-output-byte",l),h(new Error("Timeout waiting for SYN/ACK"))},3e4)})}async function li(r,t,e,s,i,n,o,h){let l=le(e,s,i,n,24,64240,h),c=ae(r,t,l);l.writeUInt16BE(c,16);let f=ce(r,t,6,l);fe(f,o)}var Cn=16;function Tn(r,t,e,s,i=64240){return le(t,r,e,s,Cn,i,Buffer.alloc(0))}function ci(r,t,e,s,i,n,o){let h=Tn(e,s,i,n,64240),a=ae(r,t,h);h.writeUInt16BE(a,16);let l=ce(r,t,6,h);return fe(l,o),n}function $e(r,t){return r.padEnd(t)}function Dt(r,t){return r.padStart(t)}function Ge(r){if(!process.env.DEBUG)return;let t=oe(r),{srcIP:e,dstIP:s}=t,i=e==="10.0.0.1"?st.green(e):st.red(e),n=s==="10.0.0.1"?st.green(s):st.red(s),o=he(t.payload),{srcPort:h,dstPort:a,seqNumber:l,ackNumber:c,flags:f,windowSize:u}=o,d=`${$e(i,16)} -> ${$e(n,16)}`,m=`TCP ${Dt(h.toString(),5)} -> ${Dt(a.toString(),5)}`,p=`[${$e(vn(f).join(", "),20)}]`,b=`Seq=${Dt(l.toString(),10)}`,g=`Ack=${Dt(c.toString(),10)}`,S=`Win=${Dt(u.toString(),5)}`;console.log(`${d} ${m} ${p} ${b} ${g} ${S}`)}var ue=class{proxyPort;serviceHosts;servicePorts;serviceHostIndex;options;proxyTlsOptions;serviceTlsOptions;proxySockets;users;allowedIPs;server=null;emulator;constructor(t,e,s,i,n){this.emulator=i,this.proxyPort=t,this.serviceHosts=this.parse(e),this.servicePorts=this.parse(s).map(Number),this.serviceHostIndex=-1,this.options=this.parseOptions(n),this.proxyTlsOptions={passphrase:this.options.passphrase,secureProtocol:"TLSv1_2_method"},this.options.tls&&(this.proxyTlsOptions.pfx=fi.readFileSync(this.options.pfx)),this.serviceTlsOptions={rejectUnauthorized:this.options.rejectUnauthorized,secureProtocol:"TLSv1_2_method"},this.proxySockets={},this.options.identUsers.length!==0?(this.users=this.options.identUsers,this.log(`Will only allow these users: ${this.users.join(", ")}`)):this.log("Will allow all users"),this.options.allowedIPs.length!==0&&(this.allowedIPs=this.options.allowedIPs),this.createListener()}parse(t){if(typeof t=="string")return t.split(",");if(typeof t=="number")return this.parse(t.toString());if(Array.isArray(t))return t;throw new Error("cannot parse object: "+t)}parseOptions(t){return Object.assign({quiet:!0,pfx:void 0,passphrase:"abcd",rejectUnauthorized:!0,identUsers:[],allowedIPs:[],tls:!1,hostname:void 0,customTlsOptions:void 0,localAddress:void 0,localPort:void 0,upstream:void 0,downstream:void 0,serviceHostSelected:void 0},t||{})}createListener(){this.options.tls?this.server=di.createServer(this.options.customTlsOptions||this.proxyTlsOptions,t=>{this.handleClientConnection(t)}):this.server=de.createServer(t=>{this.handleClientConnection(t)}),this.server.listen(this.proxyPort,this.options.hostname)}handleClientConnection(t){this.users?this.handleAuth(t):this.handleClient(t)}handleAuth(t){if(this.allowedIPs?.includes(t.remoteAddress)){this.handleClient(t);return}let e=pi.format("%d, %d",t.remotePort,this.proxyPort),s=new de.Socket,i;s.on("error",()=>{i=void 0,s.destroy()}),s.on("data",n=>{i=n.toString().trim(),s.destroy()}),s.on("close",()=>{if(!i){this.log("No identd"),t.destroy();return}let n=i.split(":").pop();this.users?.includes(n)?this.handleClient(t):(this.log(`User "${n}" unauthorized`),t.destroy())}),s.connect(113,t.remoteAddress,()=>{s.write(e),s.end()})}async handleClient(t){let e=this.uniqueKey(t);this.proxySockets[e]=t;let s={buffers:[],connected:!1,sequenceNumber:0,ackNumber:0,srcPort:An(1024,65535),proxySocket:t};this.createServiceSocket(s),[s.sequenceNumber,s.ackNumber]=await ai("10.0.0.2","10.0.0.1",3306,s.srcPort,this.emulator),t.on("data",async i=>{await this.handleUpstreamData(s,i)}),t.on("close",()=>{delete this.proxySockets[this.uniqueKey(t)],s.serviceSocket!==void 0&&s.serviceSocket.destroy()}),t.on("error",()=>{s.serviceSocket!==void 0&&s.serviceSocket.destroy()})}async handleUpstreamData(t,e){let i=[];if(e.length>768)for(let n=0;n<e.length;n+=768)i.push(e.slice(n,n+768));else i.push(e);for(let n=0;n<i.length;n++){let o=i[n];await li("10.0.0.2","10.0.0.1",3306,t.srcPort,t.sequenceNumber,t.ackNumber,this.emulator,o),o.length>0&&(t.sequenceNumber+=o.length,Number.isFinite(t.sequenceNumber)||(t.sequenceNumber=0),process.env.DEBUG&&(i.length>1?console.log(st.bold(`Sending ${o.length} bytes (chunk ${n+1}/${i.length})`)):console.log(st.bold(`Sending ${o.length} bytes`))))}}createServiceSocket(t){let e=new ui.default.Decoder({onError:s=>{console.error("error:",s)},onMessage:s=>{Ge(Buffer.from(s));let i=oe(Buffer.from(s));if(i.protocol===6){let n=he(i.payload);if(n.dstPort!==t.srcPort)return;t.ackNumber=n.seqNumber+n.payload.length,t.proxySocket.write(n.payload),n.payload.length>0&&ci("10.0.0.2","10.0.0.1",t.srcPort,3306,t.sequenceNumber,t.ackNumber,this.emulator),n.flags&16&&(t.sequenceNumber=Math.max(t.sequenceNumber,n.ackNumber))}}});this.emulator.add_listener("serial1-output-byte",s=>{e.decode(Buffer.from([s]))})}parseServiceOptions(t){let e=this.getServiceHostIndex(t.proxySocket);return Object.assign({port:this.servicePorts[e],host:this.serviceHosts[e],localAddress:this.options.localAddress,localPort:this.options.localPort},this.serviceTlsOptions)}getServiceHostIndex(t){this.serviceHostIndex++,this.serviceHostIndex==this.serviceHosts.length&&(this.serviceHostIndex=0);let e=this.serviceHostIndex;return this.options.serviceHostSelected&&(e=this.options.serviceHostSelected(t,e)),e}end(){this.server?.close();for(let t in this.proxySockets)this.proxySockets[t].destroy();this.server?.unref()}log(t){this.options.quiet||console.log(t)}intercept(t,e,s){return t?t(e,s):s}uniqueKey(t){return`${t.remoteAddress}:${t.remotePort}`}};function qe(r,t,e){return new Promise(s=>{let i="",n=o=>{let h=String.fromCharCode(o);h===`
`&&(i=""),i+=h,i.includes(t)&&(i="",r.remove_listener(`serial${e}-output-byte`,n),s())};r.add_listener(`serial${e}-output-byte`,n)})}async function D(r){await qe(r,"localhost:~#",0)}async function Qh(r,t="(none)"){await qe(r,`MariaDB [${t}]>`,1)}async function Jh(r){await D(r),await Nn(r),await Rn(r);let t=await r.save_state();await kn(On.join(Ys,"/blank.state"),Buffer.from(t))}async function Rn(r){r.serial0_send(`ip link set lo up
`),await D(r)}async function Xh(r,t){t.serial0_send(`slattach -v -L -s 115200 -p slip /dev/ttyS1   &
`),await D(t),t.serial0_send(`sysctl -w net.ipv4.ip_forward=1
`),await D(t),t.serial0_send(`ip addr add 10.0.0.1 peer 10.0.0.2 dev sl0
`),await D(t),t.serial0_send(`ip link set sl0 up
`),await D(t),t.serial0_send(`ip route add default via 10.0.0.1 dev sl0
`),await D(t)}async function ta(r,t){return new ue(r,"127.0.0.1",3306,t,{hostname:"127.0.0.1"})}async function Nn(r){r.serial0_send(`chown mysql:mysql /run/mysqld
`),await D(r),r.serial0_send(`echo '10.0.0.2 mysql' >> /etc/hosts
`),await D(r),process.env.DEBUG?r.serial0_send(`mariadb-install-db --user=mysql --basedir=/usr --datadir=/var/lib/mysql
`):r.serial0_send(`mariadb-install-db --user=mysql --basedir=/usr --datadir=/var/lib/mysql > /dev/ttyS2
`),await D(r)}async function ea(r){r.serial0_send(`setsid sh -c 'su mysql -c mysqld -s /bin/ash <> /dev/ttyS2 >&0 2>&1'
`),await D(r),await qe(r,"Alpine Linux",2),r.serial0_send(`mysql -uroot mysql -padmin -e "GRANT ALL PRIVILEGES ON *.* TO 'root'@'10.0.0.%' IDENTIFIED BY 'admin' WITH GRANT OPTION"

`),await D(r)}async function sa(r){r.serial0_send(`setsid sh -c 'su mysql -c mysql <> /dev/ttyS1 >&0 2>&1'
`),await D(r)}export{Xh as initializeMySQLNetworking,Rn as networkUp,Jh as setupBlankState,Nn as setupMySQL,ea as startMySQL,ta as startMySQLForwarding,sa as startMySQLShell,Qh as waitForMySQLPrompt,D as waitForPrompt,qe as waitForSerialLine};
